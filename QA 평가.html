<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QA í‰ê°€ ì‹œìŠ¤í…œ ëª©ì—…</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // Tailwind CSS ì‚¬ìš©ì ì •ì˜ ì„¤ì •
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'aio-primary': '#3670C7', // AIO í…Œë§ˆ ê¸°ë³¸ íŒŒë€ìƒ‰
                        'aio-secondary': '#6c757d', // AIO í…Œë§ˆ íšŒìƒ‰
                        'aio-light': '#f8f9fa', // AIO í…Œë§ˆ ë°ì€ íšŒìƒ‰
                        'aio-dark': '#343a40', // AIO í…Œë§ˆ ì–´ë‘ìš´ íšŒìƒ‰
                        'aio-border': '#dee2e6', // AIO í…Œë§ˆ í…Œë‘ë¦¬ ìƒ‰ìƒ
                        'score-up': '#16a34a', // ì ìˆ˜ ìƒìŠ¹ (ë…¹ìƒ‰)
                        'score-down': '#dc2626', // ì ìˆ˜ í•˜ë½ (ë¹¨ê°„ìƒ‰)
                        'score-same': '#6b7280', // ì ìˆ˜ ë™ì¼ (íšŒìƒ‰)
                        'goal-achieved': '#16a34a', // ëª©í‘œ ë‹¬ì„± (ë…¹ìƒ‰)
                        'goal-not-achieved': '#dc2626', // ëª©í‘œ ë¯¸ë‹¬ì„± (ë¹¨ê°„ìƒ‰)
                    },
                    fontFamily: {
                        // ê¸°ë³¸ í°íŠ¸ ì„¤ì • (Inter í¬í•¨)
                        sans: ['Inter', 'system-ui', '-apple-system', 'BlinkMacSystemFont', '"Segoe UI"', 'Roboto', '"Helvetica Neue"', 'Arial', '"Noto Sans"', 'sans-serif', '"Apple Color Emoji"', '"Segoe UI Emoji"', '"Segoe UI Symbol"', '"Noto Color Emoji"'],
                    },
                    boxShadow: {
                        // ê¸°ë³¸ ê·¸ë¦¼ì ìŠ¤íƒ€ì¼
                        'aio': '0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)',
                        'panel': '0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)' // ì‚¬ì´ë“œ íŒ¨ë„ ê·¸ë¦¼ì
                    },
                    borderRadius: {
                        // ê¸°ë³¸ í…Œë‘ë¦¬ ë‘¥ê¸€ê¸°
                        'aio': '0.375rem',
                    }
                }
            }
        }
    </script>
    <style>
        /* ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
        body { background-color: #f4f7fc; font-family: 'Inter', sans-serif; }
        /* ì¹´ë“œ ìŠ¤íƒ€ì¼ */
        .aio-card {
            background-color: white; border-radius: 0.375rem; /* rounded-aio */
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06); /* shadow-aio */
            border: 1px solid #dee2e6; /* border-aio-border */
            margin-bottom: 1.5rem; padding: 1.5rem;
        }
        /* ì…ë ¥ í•„ë“œ ë° Select ìŠ¤íƒ€ì¼ */
        select, input[type="text"], input[type="number"], input[type="date"], textarea {
            border: 1px solid #dee2e6; /* border-aio-border */
            padding: 0.5rem 0.75rem; border-radius: 0.375rem; /* rounded-aio */
            width: 100%; font-size: 0.875rem;
            transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
        }
        input[type="date"].w-auto { width: auto; } /* ë‚ ì§œ ì…ë ¥ í•„ë“œ ë„ˆë¹„ ìë™ ì¡°ì • */
        select:focus, input:focus, textarea:focus {
            border-color: #3670C7; /* focus:border-aio-primary */
            outline: 0;
            box-shadow: 0 0 0 0.2rem rgba(54, 112, 199, 0.25); /* focus:ring-aio-primary/25 */
        }
        /* í…Œì´ë¸” ìŠ¤íƒ€ì¼ */
        .aio-table { width: 100%; border-collapse: collapse; table-layout: fixed; }
        .aio-table th, .aio-table td {
            border: 1px solid #dee2e6; /* border-aio-border */
            padding: 0.75rem; text-align: left; font-size: 0.875rem;
            vertical-align: middle; word-break: break-all;
        }
        .aio-table thead th {
            background-color: #f8f9fa; /* bg-aio-light */
            font-weight: 600; color: #495057; cursor: pointer;
            position: sticky; top: 0; z-index: 10; /* ìŠ¤í‹°í‚¤ í—¤ë” */
        }
        /* ì •ë ¬ ì•„ì´ì½˜ SVG ìŠ¤íƒ€ì¼ ìœ ì§€ */
        .aio-table th .sort-icon { display: inline-block; width: 1em; height: 1em; text-align: center; color: #adb5bd; margin-left: 4px; vertical-align: middle;}
        .aio-table tbody tr:nth-child(odd):not(.detail-row) { background-color: #f8f9fa; /* bg-aio-light */ }
        .aio-table tbody tr:not(.detail-row):hover { background-color: #e9ecef; }
        /* QA í‰ê°€ ì…ë ¥ í…Œì´ë¸”: ì²«ë²ˆì§¸ ì…€ë§Œ ì»¤ì„œ ì ìš© */
        #evaluation-table-body td:first-child { cursor: pointer; }
        .aio-table td input, .aio-table td textarea, .aio-table td select { font-size: inherit; padding: 0.25rem 0.5rem; }
        .aio-table td textarea { resize: vertical; min-height: 40px; }
        /* ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .aio-button {
            display: inline-flex; align-items: center; justify-content: center; padding: 0.5rem 1rem; border-radius: 0.375rem; /* rounded-aio */
            font-weight: 600; font-size: 0.875rem; cursor: pointer; transition: background-color 0.2s, border-color 0.2s, opacity 0.2s; border: 1px solid transparent;
        }
        .aio-button:disabled {
            opacity: 0.65; cursor: not-allowed;
        }
        /* ë²„íŠ¼ ë‚´ SVG ì•„ì´ì½˜ ìŠ¤íƒ€ì¼ ìœ ì§€ */
        .aio-button svg {
            width: 1.1em; /* ì•„ì´ì½˜ í¬ê¸° */
            height: 1.1em;
            margin-right: 0.5rem; /* ì•„ì´ì½˜ ì˜¤ë¥¸ìª½ ë§ˆì§„ */
            vertical-align: middle;
        }
        .aio-button svg.m-0 { margin-right: 0; } /* ë§ˆì§„ ì œê±° í´ë˜ìŠ¤ */

        .aio-button-primary { background-color: #3670C7; color: white; border-color: #3670C7; }
        .aio-button-primary:hover:not(:disabled) { background-color: #2a5a9a; border-color: #2a5a9a; }
        .aio-button-secondary { background-color: #6c757d; color: white; border-color: #6c757d; }
        .aio-button-secondary:hover:not(:disabled) { background-color: #5a6268; border-color: #5a6268; }
        .aio-button-danger { background-color: #dc3545; color: white; border-color: #dc3545; }
        .aio-button-danger:hover:not(:disabled) { background-color: #c82333; border-color: #c82333; }
        .aio-button-light { background-color: #f8f9fa; color: #343a40; border-color: #dee2e6; }
        .aio-button-light:hover:not(:disabled) { background-color: #e2e6ea; border-color: #dae0e5; }
        /* í˜ì´ì§€ë„¤ì´ì…˜ ìŠ¤íƒ€ì¼ */
        .pagination { display: flex; justify-content: center; align-items: center; gap: 0.5rem; margin-top: 1rem; }
        .pagination button { min-width: 32px; height: 32px; padding: 0 0.5rem; }
        .pagination button.active { background-color: #3670C7; color: white; border-color: #3670C7; cursor: default; }
        /* íƒ­ ìŠ¤íƒ€ì¼ */
        .tab-container { border-bottom: 1px solid #dee2e6; margin-bottom: 1.5rem; }
        .tab-button {
            padding: 0.75rem 1.25rem; border: none; background: none; cursor: pointer;
            font-size: 1rem; font-weight: 500; color: #6c757d; border-bottom: 3px solid transparent;
            margin-bottom: -1px;
        }
        .tab-button.active { color: #3670C7; border-bottom-color: #3670C7; font-weight: 600; }
        .tab-content { display: none; }
        /* active í´ë˜ìŠ¤ê°€ ë¶™ì—ˆì„ ë•Œ ê°•ì œë¡œ ë³´ì´ë„ë¡ !important ìœ ì§€ */
        .tab-content.active {
            display: block !important;
        }
        /* ë‚´ í‰ê°€ ê²°ê³¼ ìƒì„¸ ë³´ê¸° ìŠ¤íƒ€ì¼ */
        .detail-row { display: none; /* ê¸°ë³¸ ìˆ¨ê¹€ */ }
        .detail-row.active { display: table-row; /* í™œì„±í™” ì‹œ ë³´ì„ */ }
        .detail-cell { background-color: #fdfdfe; padding: 1.5rem !important; /* ìƒì„¸ ë‚´ìš© íŒ¨ë”© */ }
        /* ìƒì„¸ í…Œì´ë¸” ì»¨í…Œì´ë„ˆ: ê°€ë¡œ/ì„¸ë¡œ ìŠ¤í¬ë¡¤ ì¶”ê°€ */
        .detail-table-container {
            max-height: 320px; /* ìƒì„¸ í…Œì´ë¸” ìµœëŒ€ ë†’ì´ */
            overflow-y: auto; /* ì„¸ë¡œ ìŠ¤í¬ë¡¤ */
            overflow-x: auto; /* ê°€ë¡œ ìŠ¤í¬ë¡¤ ì¶”ê°€ */
            border: 1px solid #e9ecef;
            border-radius: 0.25rem;
            margin-bottom: 1rem;
           }
        .detail-table { width: 100%; border-collapse: collapse; min-width: 900px; /* ë„ˆë¹„ ì¦ê°€ */ }
        .detail-table th { background-color: #e9ecef; font-size: 0.8rem; padding: 0.5rem; text-align: left; font-weight: 600; color: #495057; position: sticky; top: 0; z-index: 5; }
        .detail-table td { font-size: 0.8rem; padding: 0.5rem; background-color: #fff; border-bottom: 1px solid #e9ecef; vertical-align: top; white-space: nowrap; }
        /* ìƒì„¸ í…Œì´ë¸” ì»¬ëŸ¼ ë„ˆë¹„ ì¡°ì • í›„ ì¤„ë°”ê¿ˆ ì„¤ì • */
        .detail-table td:nth-child(5), /* í•­ëª© ê·œì • */
        .detail-table td:nth-child(6), /* ë§Œì  í¬ì¸íŠ¸ */
        .detail-table td:nth-child(7) { /* í‰ê°€ì ì½”ë©˜íŠ¸ */
            white-space: normal; /* ì½”ë©˜íŠ¸ëŠ” ì¤„ë°”ê¿ˆ í—ˆìš© */
        }
        .detail-table tbody tr:last-child td { border-bottom: none; }
        /* í† ê¸€ ë²„íŠ¼ í…ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ */
        .toggle-detail-button {
            cursor: pointer; line-height: 1; color: #6c757d; margin-right: 0;
            background: none; border: none; padding: 0; font-size: 0.8em;
            width: 1.5em; text-align: center;
        }
        /* ì ìˆ˜ ë¹„êµ í…ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ */
        .score-change { margin-left: 4px; font-weight: bold; font-size: 0.9em; display: inline-block; width: 1em; text-align: center;}
        .score-up { color: #16a34a; }
        .score-down { color: #dc2626; }
        .score-same { color: #6b7280; }
        /* ëª©í‘œ ë‹¬ì„± ì•„ì´ì½˜ ìŠ¤íƒ€ì¼ */
        .goal-status-icon { font-size: 1.1em; vertical-align: middle; }
        .goal-achieved { color: #16a34a; } /* ë…¹ìƒ‰ */
        .goal-not-achieved { color: #dc2626; } /* ë¹¨ê°„ìƒ‰ */
        .goal-set { color: #6b7280; } /* íšŒìƒ‰ */

        /* í˜„ì¬ ì„¤ì •ëœ ëª©í‘œ í‘œì‹œ ìŠ¤íƒ€ì¼ */
        #current-goals-display ul { list-style: none; padding: 0; }
        #current-goals-display li { 
            background-color: #f8f9fa; 
            padding: 0.75rem 1rem; 
            border-radius: 0.375rem; 
            margin-bottom: 0.5rem; 
            display: flex; 
            justify-content: space-between; 
            align-items: center;
            border: 1px solid #dee2e6;
        }
        #current-goals-display li .goal-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        #current-goals-display li .goal-info span:first-child { 
            font-weight: 500; 
            color: #495057;
            min-width: 100px;
        }
        #current-goals-display li .goal-info span:last-child { 
            font-weight: 600; 
            color: #3670C7;
            min-width: 60px;
        }
        #current-goals-display li .goal-actions {
            display: flex;
            gap: 0.5rem;
        }
        #current-goals-display li .goal-actions button {
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }
        #current-goals-display li .goal-actions button.edit {
            background-color: #e9ecef;
            color: #495057;
            border: 1px solid #dee2e6;
        }
        #current-goals-display li .goal-actions button.delete {
            background-color: #fee2e2;
            color: #dc2626;
            border: 1px solid #fecaca;
        }
        #current-goals-display li .goal-actions button:hover {
            opacity: 0.8;
        }

        /* ìŠ¤í¬ë¡¤ë°” ìŠ¤íƒ€ì¼ (ì„ íƒ ì‚¬í•­) */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 10px; }
        ::-webkit-scrollbar-thumb { background: #a8a8a8; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #888; }
        .scrollable-cell-content { max-height: 80px; overflow-y: auto; padding-right: 4px; }
        /* ì´ëª¨í‹°ì½˜ ìŠ¤íƒ€ì¼ */
        .status-emoji { margin-right: 0.3em; font-size: 0.9em; }

        /* ì‚¬ì´ë“œ íŒ¨ë„ ìŠ¤íƒ€ì¼ */
        #criteria-side-panel-overlay {
            position: fixed; inset: 0; background-color: rgba(0, 0, 0, 0.5);
            opacity: 0; transition: opacity 0.3s ease-in-out; z-index: 40;
            pointer-events: none;
        }
        #criteria-side-panel-overlay.active {
            opacity: 1;
            pointer-events: auto;
        }
        #criteria-side-panel {
            position: fixed; top: 0; right: 0; bottom: 0;
            width: 90%; max-width: 400px;
            background-color: white;
            box-shadow: -2px 0 15px rgba(0,0,0,0.1);
            transform: translateX(100%);
            transition: transform 0.3s ease-in-out;
            z-index: 50;
            display: flex; flex-direction: column;
        }
        #criteria-side-panel.active {
            transform: translateX(0);
        }
        #criteria-side-panel-content {
            flex-grow: 1; overflow-y: auto; padding: 1.5rem;
        }
        /* ì´ì˜ ì œê¸° ì„¹ì…˜ ìŠ¤íƒ€ì¼ */
        .objection-section-container { /* ê°€ë¡œ ë°°ì¹˜ë¥¼ ìœ„í•œ ì»¨í…Œì´ë„ˆ */
            display: flex;
            gap: 1.5rem; /* ì„¹ì…˜ ê°„ ê°„ê²© */
            margin-top: 1.5rem;
            padding-top: 1rem;
            border-top: 1px solid #e9ecef; /* ìƒë‹¨ êµ¬ë¶„ì„  */
        }
        .objection-section {
            flex: 1; /* ë™ì¼í•œ ë„ˆë¹„ë¡œ ë‚˜ëˆ„ê¸° */
            padding: 1rem; /* ë‚´ë¶€ íŒ¨ë”© */
            border: 1px solid #dee2e6; /* í…Œë‘ë¦¬ ì¶”ê°€ */
            border-radius: 0.375rem; /* ë‘¥ê·¼ ëª¨ì„œë¦¬ */
            background-color: #f8f9fa; /* ì•½ê°„ì˜ ë°°ê²½ìƒ‰ */
            margin-top: 0;
            padding-top: 0;
            border-top: none;
        }
        .objection-textarea:disabled {
             background-color: #e9ecef; /* ë¹„í™œì„±í™” ë°°ê²½ìƒ‰ */
             color: #6c757d;
        }

        /* ì»¤ìŠ¤í…€ ì´ì˜ ì œê¸° ì²´í¬ë°•ìŠ¤ ìŠ¤íƒ€ì¼ */
        .objection-checkbox {
            appearance: none; /* ê¸°ë³¸ ëª¨ì–‘ ìˆ¨ê¸°ê¸° */
            -webkit-appearance: none;
            width: 1.1rem; /* í¬ê¸° ì¡°ì • */
            height: 1.1rem;
            border: 2px solid #adb5bd; /* í…Œë‘ë¦¬ */
            border-radius: 0.25rem; /* ì•½ê°„ ë‘¥ê¸€ê²Œ */
            display: inline-block;
            vertical-align: middle; /* ì„¸ë¡œ ì •ë ¬ */
            position: relative;
            cursor: default; /* í´ë¦­ ë¶ˆê°€ í‘œì‹œ */
            background-color: #fff; /* ê¸°ë³¸ ë°°ê²½ìƒ‰ */
            transition: background-color 0.2s, border-color 0.2s;
        }
        .objection-checkbox:checked {
            background-color: #3670C7; /* ì²´í¬ ì‹œ ë°°ê²½ìƒ‰ (aio-primary) */
            border-color: #3670C7;
        }
        .objection-checkbox:checked::after {
            content: '';
            position: absolute;
            left: 4px;
            top: 1px;
            width: 5px;
            height: 9px;
            border: solid white; /* ì²´í¬ í‘œì‹œ ìƒ‰ìƒ */
            border-width: 0 2px 2px 0;
            transform: rotate(45deg);
        }

    </style>
</head>
<body class="p-6 relative">

    <div class="flex justify-between items-center mb-6">
        <h1 class="text-2xl font-semibold text-aio-dark">QA í‰ê°€ ì‹œìŠ¤í…œ</h1>
        <span class="text-sm text-aio-secondary">ë¡œê·¸ì¸: <span id="current-counselor-name">ì´ì •í›ˆ</span> (í‰ê°€ì)</span>
    </div>

    <div class="tab-container flex flex-wrap">
        <button class="tab-button active" onclick="switchTab(event, 'tab-eval-input')">QA í‰ê°€ ì…ë ¥</button>
        <button class="tab-button" onclick="switchTab(event, 'tab-other-metrics')">ê¸°íƒ€ ì§€í‘œ ì…ë ¥</button>
        <button class="tab-button" onclick="switchTab(event, 'tab-criteria-manage')">í‰ê°€ ê¸°ì¤€ ê´€ë¦¬</button>
        <button class="tab-button" onclick="switchTab(event, 'tab-my-results')">ë‚´ í‰ê°€ ê²°ê³¼</button>
    </div>

    <div id="tab-eval-input" class="tab-content active">
        <div class="aio-card">
            <h2 class="text-lg font-semibold text-aio-dark mb-4 border-b border-aio-border pb-2">ìƒë‹´ ì •ë³´</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4">
                <div> <label for="team" class="block text-sm font-medium text-gray-700 mb-1">íŒ€</label> <select id="team" name="team"> <option>ìƒë‹´ì˜ˆì•½1íŒ€</option> <option>ìƒë‹´ì˜ˆì•½2íŒ€</option> </select> </div>
                <div> <label for="part" class="block text-sm font-medium text-gray-700 mb-1">íŒŒíŠ¸</label> <select id="part" name="part"> <option>1íŒŒíŠ¸</option> <option>2íŒŒíŠ¸</option> </select> </div>
                <div> <label for="counselor" class="block text-sm font-medium text-gray-700 mb-1">ìƒë‹´ì‚¬</label> <select id="counselor" name="counselor"> <option>í™ê¸¸ë™</option> <option>ê¹€ì² ìˆ˜</option> </select> </div>
                <div> <label for="call_type" class="block text-sm font-medium text-gray-700 mb-1">ìœ í˜• (ì½œ)</label> <select id="call_type" name="call_type" onchange="updateEvaluationItems()"> <option value="ì´ˆì§„/ì¬ì´ˆì§„">ì´ˆì§„/ì¬ì´ˆì§„</option> <option value="ì¬ì§„">ì¬ì§„</option> <option value="ì¼ë°˜">ì¼ë°˜</option> <option value="ì‹œì²­ì">ì‹œì²­ì</option> </select> </div>
                <div> <label for="evaluator" class="block text-sm font-medium text-gray-700 mb-1">í‰ê°€ì</label> <select id="evaluator" name="evaluator"> <option>ì´ì •í›ˆ</option> <option>ê¶Œë¯¸</option> </select> </div>
                <div> <label for="eval_date" class="block text-sm font-medium text-gray-700 mb-1">í‰ê°€ì¼ì</label> <input type="date" id="eval_date" name="eval_date" value="2025-04-17"> </div>
                <div>
                    <label for="session_round" class="block text-sm font-medium text-gray-700 mb-1">íšŒì°¨</label>
                    <select id="session_round" name="session_round">
                        <option value="1">1íšŒì°¨</option>
                        <option value="2">2íšŒì°¨</option>
                        <option value="3">3íšŒì°¨</option>
                        <option value="4">4íšŒì°¨</option>
                    </select>
                </div>
                <div> <label for="recording_id" class="block text-sm font-medium text-gray-700 mb-1">í‰ê°€ë²ˆí˜¸(ë…¹ìŒID)</label> <input type="text" id="recording_id" name="recording_id" placeholder="ë…¹ìŒ ID ì…ë ¥"> </div>
            </div>
        </div>
        <div class="aio-card">
            <h2 id="evaluation-table-title" class="text-lg font-semibold text-aio-dark mb-4 border-b border-aio-border pb-2">í‰ê°€ í•­ëª© (ì´ˆì§„/ì¬ì´ˆì§„)</h2>
            <div class="overflow-y-auto max-h-96 border border-aio-border rounded-aio">
                <table id="evaluation-table" class="aio-table min-w-full">
                    <colgroup> <col style="width: 30%;"> <col style="width: 10%;"> <col style="width: 10%;"> <col style="width: 50%;"> </colgroup>
                    <thead> <tr> <th>í‰ê°€ í•­ëª©</th> <th>ë°°ì </th> <th class="w-24">ì ìˆ˜</th> <th>ì½”ë©˜íŠ¸</th> </tr> </thead>
                    <tbody id="evaluation-table-body">
                        </tbody>
                    <tfoot> <tr class="font-semibold bg-aio-light sticky bottom-0"> <td class="text-right">í•©ê³„</td> <td id="total-max-score" class="text-center font-bold">0</td> <td id="total-actual-score" class="text-center text-aio-primary font-bold">0</td> <td></td> </tr> </tfoot>
                </table>
            </div>
        </div>
        <div class="aio-card">
            <label for="feedback" class="block text-lg font-semibold text-aio-dark mb-2">ì „ì²´ í”¼ë“œë°±</label>
            <textarea id="feedback" name="feedback" rows="4" placeholder="í‰ê°€ì— ëŒ€í•œ ì „ì²´ì ì¸ í”¼ë“œë°±, ì˜í•œ ì , ê°œì„ ì  ë“±ì„ ìƒì„¸íˆ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
        </div>
        <div class="flex justify-end space-x-2 mb-6">
             <button type="button" class="aio-button aio-button-secondary"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>ì„ì‹œì €ì¥</button>
            <button type="button" class="aio-button aio-button-primary"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></svg>ì €ì¥</button>
            <button type="button" class="aio-button aio-button-secondary"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"/><path d="m15 5 4 4"/></svg>ìˆ˜ì •</button>
            <button type="button" class="aio-button aio-button-danger"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></svg>ì‚­ì œ</button>
            <button type="button" class="aio-button aio-button-light"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" x2="12" y1="15" y2="3"/></svg>ë‹¤ìš´ë¡œë“œ (Excel)</button>
        </div>
        <div class="aio-card overflow-x-auto">
            <h2 class="text-lg font-semibold text-aio-dark mb-4 border-b border-aio-border pb-2">í‰ê°€ ì´ë ¥ (ì „ì²´)</h2>
            <div class="flex flex-wrap items-end gap-4 mb-4">
                <div class="w-full sm:w-auto md:w-64"> <label for="history_search_term" class="block text-sm font-medium text-gray-700 mb-1">ê²€ìƒ‰ì–´</label> <input type="text" id="history_search_term" placeholder="ìƒë‹´ì‚¬, í‰ê°€ì, í‰ê°€ë²ˆí˜¸..." class="w-full"> </div>
                <div class="w-full sm:w-auto"> <label for="history_year" class="block text-sm font-medium text-gray-700 mb-1">ë…„ë„</label> <select id="history_year" class="w-full sm:w-auto"> <option value="">ë…„ë„ ì „ì²´</option><option>2025</option><option>2024</option> </select> </div>
                <div class="w-full sm:w-auto"> <label for="history_month" class="block text-sm font-medium text-gray-700 mb-1">ì›”</label> <select id="history_month" class="w-full sm:w-auto"> <option value="">ì›” ì „ì²´</option><option>4ì›”</option><option>3ì›”</option><option>2ì›”</option> </select> </div>
                <div class="w-full sm:w-auto"> <label for="history_team" class="block text-sm font-medium text-gray-700 mb-1">íŒ€</label> <select id="history_team" class="w-full sm:w-auto"> <option value="">íŒ€ ì „ì²´</option><option>ìƒë‹´ì˜ˆì•½1íŒ€</option><option>ìƒë‹´ì˜ˆì•½2íŒ€</option> </select> </div>
                <div class="w-full sm:w-auto"> <label for="history_part" class="block text-sm font-medium text-gray-700 mb-1">íŒŒíŠ¸</label> <select id="history_part" class="w-full sm:w-auto"> <option value="">íŒŒíŠ¸ ì „ì²´</option><option>1íŒŒíŠ¸</option><option>2íŒŒíŠ¸</option> </select> </div>
                <div class="w-full sm:w-auto"> <label for="history_call_type" class="block text-sm font-medium text-gray-700 mb-1">ìœ í˜•(ì½œ)</label> <select id="history_call_type" class="w-full sm:w-auto"> <option value="">ìœ í˜• ì „ì²´</option><option>ì´ˆì§„/ì¬ì´ˆì§„</option><option>ì¬ì§„</option><option>ì¼ë°˜</option><option>ì‹œì²­ì</option> </select> </div>
                <div class="w-full sm:w-auto">
                    <label for="history_session_round" class="block text-sm font-medium text-gray-700 mb-1">íšŒì°¨</label>
                    <select id="history_session_round" name="history_session_round" class="w-full sm:w-auto">
                        <option value="">íšŒì°¨ ì „ì²´</option>
                        <option value="1">1íšŒì°¨</option>
                        <option value="2">2íšŒì°¨</option>
                        <option value="3">3íšŒì°¨</option>
                        <option value="4">4íšŒì°¨</option>
                    </select>
                </div>
                <div class="w-full sm:w-auto"> <label for="history_status" class="block text-sm font-medium text-gray-700 mb-1">ìƒíƒœ</label> <select id="history_status" class="w-full sm:w-auto"> <option value="">ìƒíƒœ ì „ì²´</option><option>ì €ì¥ë¨</option><option>ì„ì‹œì €ì¥</option> </select> </div>
                <button type="button" class="aio-button aio-button-light self-end"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>ê²€ìƒ‰</button>
            </div>
            <table class="aio-table min-w-full">
                 <colgroup> <col style="width: 10%;"> <col style="width: 14%;"> <col style="width: 9%;">  <col style="width: 9%;">  <col style="width: 11%;"> <col style="width: 9%;">  <col style="width: 8%;">  <col style="width: 8%;">  <col style="width: 9%;">  <col style="width: 8%;">  <col style="width: 5%;">  </colgroup>
                <thead> <tr> <th>í‰ê°€ì¼<span class="sort-icon">â–¼</span></th> <th>í‰ê°€ë²ˆí˜¸(ID)<span class="sort-icon">â†•</span></th> <th>íŒ€<span class="sort-icon">â†•</span></th> <th>íŒŒíŠ¸<span class="sort-icon">â†•</span></th> <th>ìƒë‹´ì‚¬<span class="sort-icon">â–²</span></th> <th>ìœ í˜•(ì½œ)<span class="sort-icon">â†•</span></th> <th>íšŒì°¨<span class="sort-icon">â†•</span></th> <th>ì´ì <span class="sort-icon">â†•</span></th> <th>í‰ê°€ì<span class="sort-icon">â†•</span></th> <th>ìƒíƒœ<span class="sort-icon">â†•</span></th> <th>ì‘ì—…</th> </tr> </thead>
                <tbody>
                    <tr> <td>2025-03-15</td> <td>REC00123</td> <td>ìƒë‹´ì˜ˆì•½1íŒ€</td> <td>1íŒŒíŠ¸</td> <td>í™ê¸¸ë™</td> <td>ì´ˆì§„/ì¬ì´ˆì§„</td> <td class="text-center">3íšŒì°¨</td> <td class="text-center">95</td> <td>ì´ì •í›ˆ</td> <td><span class="inline-flex items-center px-2 py-1 text-xs font-semibold text-green-700 bg-green-100 rounded-full"><span class="status-emoji">âœ…</span>ì €ì¥ë¨</span></td> <td class="text-center"><a href="#" class="text-aio-primary hover:underline text-sm">ì¡°íšŒ</a></td> </tr>
                    <tr> <td>2025-03-10</td> <td>REC00456</td> <td>ìƒë‹´ì˜ˆì•½2íŒ€</td> <td>2íŒŒíŠ¸</td> <td>ê¹€ì² ìˆ˜</td> <td>ì¬ì§„</td> <td class="text-center">2íšŒì°¨</td> <td class="text-center">88</td> <td>ê¶Œë¯¸</td> <td><span class="inline-flex items-center px-2 py-1 text-xs font-semibold text-green-700 bg-green-100 rounded-full"><span class="status-emoji">âœ…</span>ì €ì¥ë¨</span></td> <td class="text-center"><a href="#" class="text-aio-primary hover:underline text-sm">ì¡°íšŒ</a></td> </tr>
                    <tr> <td>2025-04-01</td> <td>REC00789</td> <td>ìƒë‹´ì˜ˆì•½1íŒ€</td> <td>2íŒŒíŠ¸</td> <td>ë°•ì˜í¬</td> <td>ì¼ë°˜</td> <td class="text-center">1íšŒì°¨</td> <td class="text-center">-</td> <td>ì´ì •í›ˆ</td> <td><span class="inline-flex items-center px-2 py-1 text-xs font-semibold text-yellow-700 bg-yellow-100 rounded-full"><span class="status-emoji">ğŸ“</span>ì„ì‹œì €ì¥</span></td> <td class="text-center"><a href="#" class="text-aio-primary hover:underline text-sm">ìˆ˜ì •</a></td> </tr>
                   </tbody>
            </table>
            <div class="pagination"> <button class="aio-button aio-button-light" disabled>&lt;</button> <button class="aio-button aio-button-primary active">1</button> <button class="aio-button aio-button-light">2</button> <button class="aio-button aio-button-light">3</button> <span class="text-sm text-gray-500">...</span> <button class="aio-button aio-button-light">10</button> <button class="aio-button aio-button-light">&gt;</button> </div>
        </div>
    </div>

    <div id="tab-other-metrics" class="tab-content">
        <div class="aio-card">
            <h2 class="text-lg font-semibold text-aio-dark mb-4 border-b border-aio-border pb-2">ê¸°íƒ€ ì„±ê³¼ ì§€í‘œ ì…ë ¥</h2>
            <p class="text-sm text-gray-600 mb-6">ì¹­ì°¬/ë¶ˆë§Œ ì ‘ìˆ˜ ë‚´ì—­ ë˜ëŠ” ì½”ì¹­ ì ìˆ˜ë¥¼ ë³„ë„ë¡œ ê¸°ë¡í•©ë‹ˆë‹¤.</p>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6 pb-6 border-b border-aio-border">
                <div> <label for="other_metric_team" class="block text-sm font-medium text-gray-700 mb-1">íŒ€</label> <select id="other_metric_team" name="other_metric_team"> <option>ìƒë‹´ì˜ˆì•½1íŒ€</option> <option>ìƒë‹´ì˜ˆì•½2íŒ€</option> </select> </div>
                <div> <label for="other_metric_part" class="block text-sm font-medium text-gray-700 mb-1">íŒŒíŠ¸</label> <select id="other_metric_part" name="other_metric_part"> <option>1íŒŒíŠ¸</option> <option>2íŒŒíŠ¸</option> </select> </div>
                <div> <label for="other_metric_counselor" class="block text-sm font-medium text-gray-700 mb-1">ìƒë‹´ì‚¬</label> <select id="other_metric_counselor" name="other_metric_counselor"> <option>í™ê¸¸ë™</option> <option>ê¹€ì² ìˆ˜</option> <option>ë°•ì˜í¬</option> <option>ì´ë¯¼ì§€</option> </select> </div>
                <div> <label for="other_metric_date" class="block text-sm font-medium text-gray-700 mb-1">ì ìš© ì¼ì</label> <input type="date" id="other_metric_date" name="other_metric_date" value=""> </div>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div> <label for="compliment_count_input" class="block text-sm font-medium text-gray-700 mb-1">ì¹­ì°¬ ê±´ìˆ˜ ğŸ‘</label> <input type="number" id="compliment_count_input" name="compliment_count_input" min="0" value="0" class="text-center"> <p class="text-xs text-gray-500 mt-1">í•´ë‹¹ ì¼ìì— ë°œìƒí•œ ì¹­ì°¬ ê±´ìˆ˜ë¥¼ ì…ë ¥í•˜ì„¸ìš”.</p> </div>
                <div> <label for="complaint_count_input" class="block text-sm font-medium text-gray-700 mb-1">ë¶ˆë§Œ ê±´ìˆ˜ ğŸ‘</label> <input type="number" id="complaint_count_input" name="complaint_count_input" min="0" value="0" class="text-center"> <p class="text-xs text-gray-500 mt-1">í•´ë‹¹ ì¼ìì— ë°œìƒí•œ ë¶ˆë§Œ ê±´ìˆ˜ë¥¼ ì…ë ¥í•˜ì„¸ìš”.</p> </div>
                <div> <label for="coaching_score_input" class="block text-sm font-medium text-gray-700 mb-1">ì½”ì¹­ ì ìˆ˜ ğŸ§‘â€ğŸ«</label> <input type="number" id="coaching_score_input" name="coaching_score_input" min="0" max="100" value="0" class="text-center"> <p class="text-xs text-gray-500 mt-1">í•´ë‹¹ ì¼ìì˜ ì½”ì¹­ ì ìˆ˜ë¥¼ ì…ë ¥í•˜ì„¸ìš” (0-100).</p> </div>
            </div>
            <div class="mt-6 flex justify-end"> <button type="button" class="aio-button aio-button-primary"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></svg>ì§€í‘œ ì €ì¥</button> </div>
        </div>
        <div class="aio-card overflow-x-auto">
             <h2 class="text-lg font-semibold text-aio-dark mb-4 border-b border-aio-border pb-2">ê¸°íƒ€ ì§€í‘œ ì´ë ¥</h2>
             <div class="flex flex-col md:flex-row justify-between items-center mb-4 gap-2">
                 <div class="flex gap-2 flex-wrap items-center">
                     <div class="flex items-center gap-2"> <input type="date" class="w-auto" title="ì¡°íšŒ ì‹œì‘ì¼"> <span class="self-center">~</span> <input type="date" class="w-auto" title="ì¡°íšŒ ì¢…ë£Œì¼"> </div>
                     <select class="w-auto"> <option>íŒ€ ì „ì²´</option> <option>ìƒë‹´ì˜ˆì•½1íŒ€</option> <option>ìƒë‹´ì˜ˆì•½2íŒ€</option> </select>
                     <select class="w-auto"> <option>íŒŒíŠ¸ ì „ì²´</option> <option>1íŒŒíŠ¸</option> <option>2íŒŒíŠ¸</option> </select>
                     <select class="w-auto"> <option>ìƒë‹´ì‚¬ ì „ì²´</option> <option>í™ê¸¸ë™</option> <option>ê¹€ì² ìˆ˜</option> </select>
                     <button type="button" class="aio-button aio-button-light"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>ì´ë ¥ ê²€ìƒ‰</button>
                 </div>
             </div>
             <table class="aio-table min-w-full">
                 <colgroup> <col style="width: 15%;"> <col style="width: 12%;"> <col style="width: 12%;"> <col style="width: 15%;"> <col style="width: 8%;"> <col style="width: 8%;"> <col style="width: 8%;"> <col style="width: 12%;"> <col style="width: 10%;"> </colgroup>
                 <thead> <tr> <th>ì ìš© ì¼ì<span class="sort-icon">â–¼</span></th> <th>íŒ€<span class="sort-icon">â†•</span></th> <th>íŒŒíŠ¸<span class="sort-icon">â†•</span></th> <th>ìƒë‹´ì‚¬<span class="sort-icon">â†•</span></th> <th>ì¹­ì°¬<span class="sort-icon">â†•</span></th> <th>ë¶ˆë§Œ<span class="sort-icon">â†•</span></th> <th>ì½”ì¹­<span class="sort-icon">â†•</span></th> <th>ì…ë ¥ì<span class="sort-icon">â†•</span></th> <th>ì‘ì—…</th> </tr> </thead>
                 <tbody>
                     <tr> <td>2025-03-15</td> <td>ìƒë‹´ì˜ˆì•½1íŒ€</td> <td>1íŒŒíŠ¸</td> <td>í™ê¸¸ë™</td> <td class="text-center">2</td> <td class="text-center">0</td> <td class="text-center">90</td> <td>ì´ì •í›ˆ</td>
                         <td class="text-center">
                             <button class="aio-button aio-button-light text-xs p-1"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="m-0 w-4 h-4"><path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"/><path d="m15 5 4 4"/></svg></button>
                             <button class="aio-button aio-button-danger text-xs p-1 ml-1"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="m-0 w-4 h-4"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></svg></button>
                         </td>
                     </tr>
                     <tr> <td>2025-03-10</td> <td>ìƒë‹´ì˜ˆì•½2íŒ€</td> <td>2íŒŒíŠ¸</td> <td>ê¹€ì² ìˆ˜</td> <td class="text-center">0</td> <td class="text-center">1</td> <td class="text-center">85</td> <td>ê¶Œë¯¸</td>
                         <td class="text-center">
                             <button class="aio-button aio-button-light text-xs p-1"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="m-0 w-4 h-4"><path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"/><path d="m15 5 4 4"/></svg></button>
                             <button class="aio-button aio-button-danger text-xs p-1 ml-1"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="m-0 w-4 h-4"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></svg></button>
                         </td>
                     </tr>
                    </tbody>
             </table>
             <div class="pagination"> <button class="aio-button aio-button-light" disabled>&lt;</button> <button class="aio-button aio-button-primary active">1</button> <button class="aio-button aio-button-light">2</button> <button class="aio-button aio-button-light">&gt;</button> </div>
        </div>
    </div>

    <div id="tab-criteria-manage" class="tab-content">
        <div class="aio-card">
            <h2 class="text-lg font-semibold text-aio-dark mb-4">í‰ê°€ ê¸°ì¤€ ê´€ë¦¬</h2>
            <div class="flex flex-wrap gap-4 mb-4 items-end">
                <div> <label for="manage_call_type_filter" class="block text-sm font-medium text-gray-700 mb-1">ì½œ ìœ í˜• í•„í„°</label> <select id="manage_call_type_filter" name="manage_call_type_filter" class="w-auto" onchange="filterCriteriaTable()"> <option value="ì „ì²´">ì „ì²´</option> <option value="ì´ˆì§„/ì¬ì´ˆì§„">ì´ˆì§„/ì¬ì´ˆì§„</option> <option value="ì¬ì§„">ì¬ì§„</option> <option value="ì¼ë°˜">ì¼ë°˜</option> <option value="ì‹œì²­ì">ì‹œì²­ì</option> </select> </div>
                <button type="button" class="aio-button aio-button-light" onclick="filterCriteriaTable()"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>ì¡°íšŒ</button>
                 <div id="criteria-max-score-sum-display" class="ml-auto text-sm font-semibold text-aio-secondary"></div>
            </div>
            <div class="overflow-auto max-h-96 border border-aio-border rounded-aio">
                <table id="criteria-management-table" class="aio-table min-w-[1000px]">
                    <colgroup> <col style="width: 10%;"> <col style="width: 15%;"> <col style="width: 8%;"> <col style="width: 27%;"> <col style="width: 27%;"> <col style="width: 13%;"> </colgroup>
                    <thead> <tr> <th class="sticky top-0 z-10">ì½œ ìœ í˜•</th> <th class="sticky top-0 z-10">í‰ê°€ í•­ëª©</th> <th class="sticky top-0 z-10">ë°°ì </th> <th class="sticky top-0 z-10">í•­ëª© ê·œì •</th> <th class="sticky top-0 z-10">ë§Œì  í¬ì¸íŠ¸</th> <th class="sticky top-0 z-10">ì‘ì—…</th> </tr> </thead>
                    <tbody id="criteria-table-body">
                        <tr data-call-type="ì´ˆì§„/ì¬ì´ˆì§„"> <td><select onchange="this.closest('tr').setAttribute('data-call-type', this.value); filterCriteriaTable();"><option selected>ì´ˆì§„/ì¬ì´ˆì§„</option><option>ì¬ì§„</option><option>ì¼ë°˜</option><option>ì‹œì²­ì</option></select></td> <td><input type="text" value="ë§ì´ì¸ì‚¬"></td> <td><input type="number" value="5" class="text-center criteria-score" oninput="updateCriteriaTotalScore()"></td> <td><textarea rows="2">ê³ ê°ì„ ë§ì´í•  ë•Œì˜ ì²«ì¸ì‚¬ ë° íƒœë„</textarea></td> <td><textarea rows="2">ë°ê³  ëª…í™•í•œ ëª©ì†Œë¦¬, ì†Œì†/ì´ë¦„ ì •í™•íˆ ë°í˜, ì •ì¤‘í•œ ì¸ì‚¬</textarea></td>
                            <td class="text-center"> <button type="button" class="aio-button aio-button-danger text-xs p-1" onclick="removeCriteriaItem(this)"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="m-0 w-4 h-4"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></svg></button> </td> </tr>
                        <tr data-call-type="ì´ˆì§„/ì¬ì´ˆì§„"> <td><select onchange="this.closest('tr').setAttribute('data-call-type', this.value); filterCriteriaTable();"><option selected>ì´ˆì§„/ì¬ì´ˆì§„</option><option>ì¬ì§„</option><option>ì¼ë°˜</option><option>ì‹œì²­ì</option></select></td> <td><input type="text" value="ê³ ê° ì •ë³´ í™•ì¸"></td> <td><input type="number" value="10" class="text-center criteria-score" oninput="updateCriteriaTotalScore()"></td> <td><textarea rows="2">ìƒë‹´ ì§„í–‰ì— í•„ìš”í•œ ê³ ê° ì •ë³´ í™•ì¸ ì ˆì°¨ ì¤€ìˆ˜ ì—¬ë¶€</textarea></td> <td><textarea rows="2">ê°œì¸ì •ë³´ë³´í˜¸ ì•ˆë‚´, í•„ìˆ˜ ì •ë³´(ì´ë¦„, ì—°ë½ì²˜ ë“±) ëˆ„ë½ ì—†ì´ í™•ì¸</textarea></td>
                            <td class="text-center"> <button type="button" class="aio-button aio-button-danger text-xs p-1" onclick="removeCriteriaItem(this)"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="m-0 w-4 h-4"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></svg></button> </td> </tr>
                         <tr data-call-type="ì´ˆì§„/ì¬ì´ˆì§„"> <td><select onchange="this.closest('tr').setAttribute('data-call-type', this.value); filterCriteriaTable();"><option selected>ì´ˆì§„/ì¬ì´ˆì§„</option><option>ì¬ì§„</option><option>ì¼ë°˜</option><option>ì‹œì²­ì</option></select></td> <td><input type="text" value="ê²½ì²­ íƒœë„"></td> <td><input type="number" value="10" class="text-center criteria-score" oninput="updateCriteriaTotalScore()"></td> <td><textarea rows="2">ê³ ê°ì˜ ë§ì„ ì£¼ì˜ ê¹Šê²Œ ë“£ê³  ì´í•´í•˜ë ¤ëŠ” íƒœë„. ê³ ê°ì˜ ê°ì •ì„ ì´í•´í•˜ê³  ì ì ˆíˆ ë°˜ì‘í•˜ë©°, ëŒ€í™”ì˜ íë¦„ì„ ìì—°ìŠ¤ëŸ½ê²Œ ìœ ì§€</textarea></td> <td><textarea rows="2">ì ì ˆí•œ ë§ì¥êµ¬, ê³ ê° ë§ ëŠì§€ ì•ŠìŒ, ë©”ëª¨í•˜ë©° ê²½ì²­, ê³ ê°ì˜ ë§ ìš”ì•½ í™•ì¸, ë¹„ì–¸ì–´ì  í‘œí˜„(ëª©ì†Œë¦¬ í†¤ ë“±) ê¸ì •ì  ìœ ì§€</textarea></td>
                             <td class="text-center"> <button type="button" class="aio-button aio-button-danger text-xs p-1" onclick="removeCriteriaItem(this)"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="m-0 w-4 h-4"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></svg></button> </td> </tr>
                         <tr data-call-type="ì´ˆì§„/ì¬ì´ˆì§„"> <td><select onchange="this.closest('tr').setAttribute('data-call-type', this.value); filterCriteriaTable();"><option selected>ì´ˆì§„/ì¬ì´ˆì§„</option><option>ì¬ì§„</option><option>ì¼ë°˜</option><option>ì‹œì²­ì</option></select></td> <td><input type="text" value="ë¬¸ì˜ ë‚´ìš© íŒŒì•…"></td> <td><input type="number" value="15" class="text-center criteria-score" oninput="updateCriteriaTotalScore()"></td> <td><textarea rows="2">ê³ ê° ë¬¸ì˜ì˜ í•µì‹¬ì„ ì •í™•íˆ íŒŒì•…í•˜ëŠ” ëŠ¥ë ¥</textarea></td> <td><textarea rows="2">í•µì‹¬ ì§ˆë¬¸ í†µí•´ ëª…í™•í™”, ì¬í™•ì¸ ì ˆì°¨</textarea></td>
                             <td class="text-center"> <button type="button" class="aio-button aio-button-danger text-xs p-1" onclick="removeCriteriaItem(this)"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="m-0 w-4 h-4"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></svg></button> </td> </tr>
                         <tr data-call-type="ì´ˆì§„/ì¬ì´ˆì§„"> <td><select onchange="this.closest('tr').setAttribute('data-call-type', this.value); filterCriteriaTable();"><option selected>ì´ˆì§„/ì¬ì´ˆì§„</option><option>ì¬ì§„</option><option>ì¼ë°˜</option><option>ì‹œì²­ì</option></select></td> <td><input type="text" value="í•´ê²° ë°©ì•ˆ ì œì‹œ"></td> <td><input type="number" value="15" class="text-center criteria-score" oninput="updateCriteriaTotalScore()"></td> <td><textarea rows="2">ê³ ê° ë¬¸ì œ í•´ê²°ì„ ìœ„í•œ ì ì ˆí•˜ê³  ëª…í™•í•œ ë°©ì•ˆ ì œì‹œ</textarea></td> <td><textarea rows="2">ì •í™•í•œ ì •ë³´ ê¸°ë°˜, ê³ ê° ë§ì¶¤ í•´ê²°ì±…, ëŒ€ì•ˆ ì œì‹œ</textarea></td>
                             <td class="text-center"> <button type="button" class="aio-button aio-button-danger text-xs p-1" onclick="removeCriteriaItem(this)"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="m-0 w-4 h-4"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></svg></button> </td> </tr>
                        <tr data-call-type="ì¬ì§„"> <td><select onchange="this.closest('tr').setAttribute('data-call-type', this.value); filterCriteriaTable();"><option>ì´ˆì§„/ì¬ì´ˆì§„</option><option selected>ì¬ì§„</option><option>ì¼ë°˜</option><option>ì‹œì²­ì</option></select></td> <td><input type="text" value="ì´ì „ ìƒë‹´ ì´ë ¥ í™•ì¸"></td> <td><input type="number" value="10" class="text-center criteria-score" oninput="updateCriteriaTotalScore()"></td> <td><textarea rows="2">ì¬ì§„ ê³ ê°ì˜ ì´ì „ ìƒë‹´ ë‚´ìš© í™•ì¸ ë° í™œìš© ì—¬ë¶€</textarea></td> <td><textarea rows="2">ì´ì „ ìƒë‹´ ë‚´ìš© ìš”ì•½ ì–¸ê¸‰, ì¤‘ë³µ ì§ˆë¬¸ ìµœì†Œí™”</textarea></td>
                            <td class="text-center"> <button type="button" class="aio-button aio-button-danger text-xs p-1" onclick="removeCriteriaItem(this)"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="m-0 w-4 h-4"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></svg></button> </td> </tr>
                        <tr data-call-type="ì¬ì§„"> <td><select onchange="this.closest('tr').setAttribute('data-call-type', this.value); filterCriteriaTable();"><option>ì´ˆì§„/ì¬ì´ˆì§„</option><option selected>ì¬ì§„</option><option>ì¼ë°˜</option><option>ì‹œì²­ì</option></select></td> <td><input type="text" value="ë¬¸ì˜ ë‚´ìš© ë³€í™” í™•ì¸"></td> <td><input type="number" value="10" class="text-center criteria-score" oninput="updateCriteriaTotalScore()"></td> <td><textarea rows="2">ì´ì „ ë¬¸ì˜ ëŒ€ë¹„ í˜„ì¬ ê³ ê° ìƒí™© ë³€í™” í™•ì¸</textarea></td> <td><textarea rows="2">í˜¸ì „/ì•…í™” ì—¬ë¶€ ì§ˆë¬¸, ì¶”ê°€ ë¶ˆí¸ì‚¬í•­ í™•ì¸</textarea></td>
                            <td class="text-center"> <button type="button" class="aio-button aio-button-danger text-xs p-1" onclick="removeCriteriaItem(this)"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="m-0 w-4 h-4"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></svg></button> </td> </tr>
                         <tr data-call-type="ì¬ì§„"> <td><select onchange="this.closest('tr').setAttribute('data-call-type', this.value); filterCriteriaTable();"><option>ì´ˆì§„/ì¬ì´ˆì§„</option><option selected>ì¬ì§„</option><option>ì¼ë°˜</option><option>ì‹œì²­ì</option></select></td> <td><input type="text" value="ê³µê° í‘œí˜„"></td> <td><input type="number" value="10" class="text-center criteria-score" oninput="updateCriteriaTotalScore()"></td> <td><textarea rows="2">ê³ ê°ì˜ ìƒí™©ê³¼ ê°ì •ì— ëŒ€í•œ ì ì ˆí•œ ê³µê° í‘œí˜„</textarea></td> <td><textarea rows="2">ì ì ˆí•œ ê³µê° ì–´íœ˜ ì‚¬ìš©, ê³ ê° ê°ì • ì´í•´ ë…¸ë ¥</textarea></td>
                             <td class="text-center"> <button type="button" class="aio-button aio-button-danger text-xs p-1" onclick="removeCriteriaItem(this)"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="m-0 w-4 h-4"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></svg></button> </td> </tr>
                        <tr data-call-type="ì¼ë°˜"> <td><select onchange="this.closest('tr').setAttribute('data-call-type', this.value); filterCriteriaTable();"><option>ì´ˆì§„/ì¬ì´ˆì§„</option><option>ì¬ì§„</option><option selected>ì¼ë°˜</option><option>ì‹œì²­ì</option></select></td> <td><input type="text" value="ë¬¸ì˜ ìœ í˜• ë¶„ë¥˜"></td> <td><input type="number" value="5" class="text-center criteria-score" oninput="updateCriteriaTotalScore()"></td> <td><textarea rows="2">ê³ ê° ë¬¸ì˜ ìœ í˜•ì„ ì •í™•íˆ íŒŒì•…í•˜ê³  ë¶„ë¥˜í•˜ëŠ” ëŠ¥ë ¥</textarea></td> <td><textarea rows="2">ë¬¸ì˜ í•µì‹¬ íŒŒì•…, ê´€ë ¨ ë¶€ì„œ/ë‹´ë‹¹ì ì—°ê²° ì •í™•ì„±</textarea></td>
                            <td class="text-center"> <button type="button" class="aio-button aio-button-danger text-xs p-1" onclick="removeCriteriaItem(this)"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="m-0 w-4 h-4"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></svg></button> </td> </tr>
                        <tr data-call-type="ì‹œì²­ì"> <td><select onchange="this.closest('tr').setAttribute('data-call-type', this.value); filterCriteriaTable();"><option>ì´ˆì§„/ì¬ì´ˆì§„</option><option>ì¬ì§„</option><option>ì¼ë°˜</option><option selected>ì‹œì²­ì</option></select></td> <td><input type="text" value="ë°©ì†¡ ë‚´ìš© ì´í•´ë„"></td> <td><input type="number" value="15" class="text-center criteria-score" oninput="updateCriteriaTotalScore()"></td> <td><textarea rows="2">ì‹œì²­ì ë¬¸ì˜ ê´€ë ¨ ë°©ì†¡ ë‚´ìš© ìˆ™ì§€ ë° ì´í•´ ì •ë„</textarea></td> <td><textarea rows="2">ë°©ì†¡ ì‹œê°„, ì±„ë„, ì£¼ìš” ë‚´ìš© ë“± ì •í™•íˆ ì•ˆë‚´</textarea></td>
                            <td class="text-center"> <button type="button" class="aio-button aio-button-danger text-xs p-1" onclick="removeCriteriaItem(this)"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="m-0 w-4 h-4"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></svg></button> </td> </tr>
                       </tbody>
                </table>
            </div>
             <div class="mt-4 flex justify-end space-x-2">
                 <button type="button" class="aio-button aio-button-secondary" onclick="addCriteriaItem()"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" x2="12" y1="5" y2="19"/><line x1="5" x2="19" y1="12" y2="12"/></svg>
                     í•­ëª© ì¶”ê°€
                 </button>
                 <button type="button" class="aio-button aio-button-primary"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></svg>
                     í‰ê°€ ê¸°ì¤€ ì €ì¥
                 </button>
             </div>
        </div>
    </div>

    <div id="tab-my-results" class="tab-content">
        <div class="aio-card">
            <h2 class="text-lg font-semibold text-aio-dark mb-4 border-b border-aio-border pb-2">ë‹¤ìŒ í‰ê°€ ëª©í‘œ ì„¤ì • (ì‹œë®¬ë ˆì´ì…˜)</h2>
            <div class="flex gap-6">
                <!-- ëª©í‘œ ì„¤ì • ì„¹ì…˜ -->
                <div class="flex-1">
                    <div class="flex flex-wrap items-end gap-4">
                        <div>
                            <label for="goal_year" class="block text-sm font-medium text-gray-700 mb-1">í‰ê°€ ë…„ë„</label>
                            <select id="goal_year" name="goal_year" class="w-auto" onchange="loadYearGoals()">
                                <option value="2024">2024ë…„</option>
                                <option value="2023">2023ë…„</option>
                                <option value="2022">2022ë…„</option>
                            </select>
                        </div>
                        <div>
                            <label for="goal_round" class="block text-sm font-medium text-gray-700 mb-1">í‰ê°€ íšŒì°¨</label>
                            <select id="goal_round" name="goal_round" class="w-auto" onchange="loadRoundGoals()">
                                <option value="1">1íšŒì°¨</option>
                                <option value="2">2íšŒì°¨</option>
                                <option value="3">3íšŒì°¨</option>
                                <option value="4">4íšŒì°¨</option>
                            </select>
                        </div>
                        <div>
                            <label for="goal_call_type" class="block text-sm font-medium text-gray-700 mb-1">ëª©í‘œ ì½œ ìœ í˜•</label>
                            <select id="goal_call_type" name="goal_call_type" class="w-auto">
                                <option value="ì´ˆì§„/ì¬ì´ˆì§„">ì´ˆì§„/ì¬ì´ˆì§„</option>
                                <option value="ì¬ì§„">ì¬ì§„</option>
                                <option value="ì¼ë°˜">ì¼ë°˜</option>
                                <option value="ì‹œì²­ì">ì‹œì²­ì</option>
                            </select>
                        </div>
                        <div>
                            <label for="goal_target_score" class="block text-sm font-medium text-gray-700 mb-1">ëª©í‘œ ì ìˆ˜</label>
                            <input type="number" id="goal_target_score" name="goal_target_score" min="0" max="100" placeholder="0-100" class="w-28">
                        </div>
                        <button type="button" class="aio-button aio-button-primary" onclick="setEvaluationGoal()">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v6h-2zm0 8h2v2h-2z"/><circle cx="12" cy="12" r="3"/></svg>
                            ëª©í‘œ ì„¤ì •
                        </button>
                        <span id="goal-set-feedback" class="text-sm text-green-600 ml-2"></span>
                    </div>
                </div>

                <!-- í˜„ì¬ ì„¤ì •ëœ ëª©í‘œ í‘œì‹œ ì„¹ì…˜ -->
                <div class="flex-1 border-l border-aio-border pl-6">
                    <div id="current-goals-display">
                        <h3 class="text-sm font-semibold text-gray-600 mb-2">í˜„ì¬ ì„¤ì •ëœ ëª©í‘œ ì ìˆ˜</h3>
                    </div>
                </div>
            </div>
        </div>

        <div class="aio-card">
            <h2 class="text-lg font-semibold text-aio-dark mb-4 border-b border-aio-border pb-2">ë‚´ í‰ê°€ ê²°ê³¼ ì¡°íšŒ</h2>
            <div class="flex flex-wrap items-center justify-between gap-4 mb-6">
                <div class="flex flex-wrap items-center gap-2">
                    <div class="flex items-center">
                        <span class="text-sm font-medium text-gray-700 mr-2">ìƒë‹´ì‚¬ :</span>
                        <span id="my-results-counselor-name" class="text-sm font-semibold text-aio-dark">í™ê¸¸ë™</span> </div>
                    <select id="my_results_year" class="w-auto text-sm" title="ë…„ë„ ì„ íƒ"> <option value="">ë…„ë„ ì „ì²´</option><option>2025</option><option>2024</option> </select>
                    <select id="my_results_month" class="w-auto text-sm" title="ì›” ì„ íƒ"> <option value="">ì›” ì „ì²´</option><option>4ì›”</option><option>3ì›”</option><option>2ì›”</option> </select>
                    <select id="my_results_call_type" class="w-auto text-sm" title="ìœ í˜•(ì½œ) ì„ íƒ"> <option value="">ìœ í˜•(ì½œ) ì „ì²´</option><option>ì´ˆì§„/ì¬ì´ˆì§„</option><option>ì¬ì§„</option><option>ì¼ë°˜</option><option>ì‹œì²­ì</option> </select>
                    <button type="button" class="aio-button aio-button-light text-sm py-1.5" onclick="renderMyResults()"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>ê²€ìƒ‰</button>
                </div>
            </div>

            <table class="aio-table min-w-full mb-6">
                <colgroup>
                    <col style="width: 5%;">  <col style="width: 10%;"> <col style="width: 13%;"> <col style="width: 7%;">  <col style="width: 10%;"> <col style="width: 7%;"> <col style="width: 6%;"> <col style="width: 10%;"> <col style="width: 26%;"> <col style="width: 6%;">  </colgroup>
                <thead>
                    <tr>
                        <th></th> <th>í‰ê°€ì¼<span class="sort-icon">â–¼</span></th>
                        <th>í‰ê°€ë²ˆí˜¸(ID)<span class="sort-icon">â†•</span></th>
                        <th class="text-center">íšŒì°¨<span class="sort-icon">â†•</span></th>
                        <th>ìœ í˜•(ì½œ)<span class="sort-icon">â†•</span></th>
                        <th class="text-center">ì´ì <span class="sort-icon">â†•</span></th>
                        <th class="text-center">ëª©í‘œ<br>ë‹¬ì„±<span class="sort-icon">â†•</span></th>
                        <th>í‰ê°€ì<span class="sort-icon">â†•</span></th>
                        <th>ì „ì²´ í”¼ë“œë°±(ìš”ì•½)<span class="sort-icon">â†•</span></th>
                        <th class="text-center">ì´ì˜<br>ì œê¸°<span class="sort-icon">â†•</span></th>
                    </tr>
                </thead>
                <tbody id="my-results-summary-body">
                    </tbody>
            </table>

            <div class="pagination">
                <button class="aio-button aio-button-light" disabled>&lt;</button>
                <button class="aio-button aio-button-primary active">1</button>
                <button class="aio-button aio-button-light">2</button>
                <button class="aio-button aio-button-light">&gt;</button>
            </div>
        </div>
    </div>

    <div id="criteria-side-panel-overlay" onclick="hideSidePanel()"></div> <div id="criteria-side-panel">
        <div class="flex justify-between items-center p-4 border-b border-aio-border bg-aio-light">
            <h3 class="text-lg font-semibold text-aio-dark">í‰ê°€ ê¸°ì¤€ ìƒì„¸</h3>
            <button onclick="hideSidePanel()" class="text-aio-secondary hover:text-aio-dark">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6 m-0"><line x1="18" x2="6" y1="6" y2="18"/><line x1="6" x2="18" y1="6" y2="18"/></svg>
            </button>
        </div>
        <div id="criteria-side-panel-content">
            <div class="mb-4">
                <h4 class="text-sm font-semibold text-gray-600 mb-1">í‰ê°€ í•­ëª©</h4>
                <p id="panel-item-name" class="text-lg font-semibold text-aio-dark"></p>
            </div>
            <div class="mb-4">
                <h4 class="text-sm font-semibold text-gray-600 mb-1">í•­ëª© ê·œì •</h4>
                <p id="panel-item-rule" class="text-sm text-gray-700 whitespace-pre-wrap"></p>
            </div>
            <div>
                <h4 class="text-sm font-semibold text-gray-600 mb-1">ë§Œì  í¬ì¸íŠ¸</h4>
                <p id="panel-item-points" class="text-sm text-gray-700 whitespace-pre-wrap"></p>
            </div>
        </div>
    </div>


    <script>
        // --- ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ ---
        const $ = (selector) => document.querySelector(selector);
        const $$ = (selector) => document.querySelectorAll(selector);
        const currentCounselor = 'í™ê¸¸ë™'; // í˜„ì¬ ë¡œê·¸ì¸í•œ ìƒë‹´ì‚¬ (ì˜ˆì‹œ)

        // --- ë°ì´í„° (ëª©ì—…ìš©) ---
        // ìƒë‹´ì‚¬ë³„ ëª©í‘œ ì ìˆ˜ ë°ì´í„°
        let userGoals = {
            'í™ê¸¸ë™': {
                '2024': {
                    '1': { // 1íšŒì°¨
                        'ì´ˆì§„/ì¬ì´ˆì§„': 90,
                        'ì¬ì§„': 85,
                        'ì¼ë°˜': 80,
                        'ì‹œì²­ì': 75
                    },
                    '2': { // 2íšŒì°¨
                        'ì´ˆì§„/ì¬ì´ˆì§„': 92,
                        'ì¬ì§„': 87,
                        'ì¼ë°˜': 82,
                        'ì‹œì²­ì': 77
                    },
                    '3': {}, // 3íšŒì°¨ (ë¹ˆ ê°ì²´ë¡œ ì´ˆê¸°í™”)
                    '4': {}  // 4íšŒì°¨ (ë¹ˆ ê°ì²´ë¡œ ì´ˆê¸°í™”)
                },
                '2023': {
                    '1': {
                        'ì´ˆì§„/ì¬ì´ˆì§„': 88,
                        'ì¬ì§„': 83,
                        'ì¼ë°˜': 78,
                        'ì‹œì²­ì': 73
                    },
                    '2': {
                        'ì´ˆì§„/ì¬ì´ˆì§„': 90,
                        'ì¬ì§„': 85,
                        'ì¼ë°˜': 80,
                        'ì‹œì²­ì': 75
                    },
                    '3': {},
                    '4': {}
                }
            },
            'ê¹€ì² ìˆ˜': {}
        };

        // ìƒë‹´ì‚¬ë³„ í‰ê°€ ê²°ê³¼ ë°ì´í„° (ì˜ˆì‹œ - ì½”ë©˜íŠ¸ ì¶”ê°€)
        const evaluationResults = {
            'í™ê¸¸ë™': [
                { id: 'eval-001', date: '2025-03-15', recordingId: 'REC00123', round: '3íšŒì°¨', callType: 'ì´ˆì§„/ì¬ì´ˆì§„', totalScore: 95, evaluator: 'ì´ì •í›ˆ', feedbackSummary: 'ì „ë°˜ì ìœ¼ë¡œ ìš°ìˆ˜. ë ì¸ì‚¬ ë³´ì™„ í•„ìš”...', hasObjection: true, objectionText: 'ê²½ì²­ íƒœë„ ì ìˆ˜ ê´€ë ¨í•˜ì—¬ ì´ì˜ ì œê¸°í•©ë‹ˆë‹¤. ë‹¹ì‹œ ê³ ê°ì˜ ë§ì´ ê¸¸ì–´ì ¸ ë¶€ë“ì´í•˜ê²Œ ì •ë¦¬í•˜ë©° ì•ˆë‚´í–ˆìŠµë‹ˆë‹¤.', evaluatorResponse: 'í™•ì¸ ê²°ê³¼, ê³ ê° ë°œí™”ê°€ ê¸¸ì–´ì§„ ì ì€ ì¸ì •ë˜ë‚˜, ì¡°ê¸ˆ ë” ë¶€ë“œëŸ½ê²Œ ì •ë¦¬í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤. ë‹¤ìŒ í‰ê°€ ì‹œ ì°¸ê³ í•˜ê² ìŠµë‹ˆë‹¤.',
                  details: [
                      { name: 'ë§ì´ì¸ì‚¬', maxScore: 5, score: 5, change: 'up', rule: 'ê³ ê°ì„ ë§ì´í•  ë•Œì˜ ì²«ì¸ì‚¬ ë° íƒœë„', points: 'ë°ê³  ëª…í™•í•œ ëª©ì†Œë¦¬, ì†Œì†/ì´ë¦„ ì •í™•íˆ ë°í˜, ì •ì¤‘í•œ ì¸ì‚¬', comment: 'ë§¤ìš° ì˜í•¨. ì´ì „ í‰ê°€ ëŒ€ë¹„ ê°œì„ ë¨.' },
                      { name: 'ê³ ê° ì •ë³´ í™•ì¸', maxScore: 10, score: 10, change: 'same', rule: 'ìƒë‹´ ì§„í–‰ì— í•„ìš”í•œ ê³ ê° ì •ë³´ í™•ì¸ ì ˆì°¨ ì¤€ìˆ˜ ì—¬ë¶€', points: 'ê°œì¸ì •ë³´ë³´í˜¸ ì•ˆë‚´, í•„ìˆ˜ ì •ë³´(ì´ë¦„, ì—°ë½ì²˜ ë“±) ëˆ„ë½ ì—†ì´ í™•ì¸', comment: 'ëˆ„ë½ ì—†ì´ ì •í™•íˆ í™•ì¸. (ìœ ì§€)' },
                      { name: 'ê²½ì²­ íƒœë„', maxScore: 10, score: 9, change: 'down', rule: 'ê³ ê°ì˜ ë§ì„ ì£¼ì˜ ê¹Šê²Œ ë“£ê³  ì´í•´í•˜ë ¤ëŠ” íƒœë„. ê³ ê°ì˜ ê°ì •ì„ ì´í•´í•˜ê³  ì ì ˆíˆ ë°˜ì‘í•˜ë©°, ëŒ€í™”ì˜ íë¦„ì„ ìì—°ìŠ¤ëŸ½ê²Œ ìœ ì§€', points: 'ì ì ˆí•œ ë§ì¥êµ¬, ê³ ê° ë§ ëŠì§€ ì•ŠìŒ, ë©”ëª¨í•˜ë©° ê²½ì²­, ê³ ê°ì˜ ë§ ìš”ì•½ í™•ì¸, ë¹„ì–¸ì–´ì  í‘œí˜„(ëª©ì†Œë¦¬ í†¤ ë“±) ê¸ì •ì  ìœ ì§€', comment: 'ê°€ë” ê³ ê° ë§ì„ ëŠëŠ” ê²½í–¥ ìˆìŒ. ê°œì„  í•„ìš”.' },
                      { name: 'ë¬¸ì˜ ë‚´ìš© íŒŒì•…', maxScore: 15, score: 14, change: 'same', rule: 'ê³ ê° ë¬¸ì˜ì˜ í•µì‹¬ì„ ì •í™•íˆ íŒŒì•…í•˜ëŠ” ëŠ¥ë ¥', points: 'í•µì‹¬ ì§ˆë¬¸ í†µí•´ ëª…í™•í™”, ì¬í™•ì¸ ì ˆì°¨', comment: 'ëŒ€ì²´ë¡œ ì˜ íŒŒì•…í•¨.' },
                      { name: 'í•´ê²° ë°©ì•ˆ ì œì‹œ', maxScore: 15, score: 15, change: 'up', rule: 'ê³ ê° ë¬¸ì œ í•´ê²°ì„ ìœ„í•œ ì ì ˆí•˜ê³  ëª…í™•í•œ ë°©ì•ˆ ì œì‹œ', points: 'ì •í™•í•œ ì •ë³´ ê¸°ë°˜, ê³ ê° ë§ì¶¤ í•´ê²°ì±…, ëŒ€ì•ˆ ì œì‹œ', comment: 'ë§¤ìš° ëª…í™•í•˜ê²Œ ì œì‹œí•¨.' }
                  ] },
                { id: 'eval-003', date: '2025-04-10', recordingId: 'REC00850', round: '4íšŒì°¨', callType: 'ì´ˆì§„/ì¬ì´ˆì§„', totalScore: 97, evaluator: 'ì´ì •í›ˆ', feedbackSummary: 'ëª©í‘œ ë‹¬ì„±! íŠ¹íˆ ê²½ì²­ íƒœë„ ê°œì„ ë¨.', hasObjection: false, objectionText: '', evaluatorResponse: '',
                  details: [
                       { name: 'ë§ì´ì¸ì‚¬', maxScore: 5, score: 5, change: 'same', rule: 'ê³ ê°ì„ ë§ì´í•  ë•Œì˜ ì²«ì¸ì‚¬ ë° íƒœë„', points: 'ë°ì€ ëª©ì†Œë¦¬ ìœ ì§€ ì˜í•˜ê³  ìˆìŒ.' },
                       { name: 'ê³ ê° ì •ë³´ í™•ì¸', maxScore: 10, score: 10, change: 'same', rule: 'ìƒë‹´ ì§„í–‰ì— í•„ìš”í•œ ê³ ê° ì •ë³´ í™•ì¸ ì ˆì°¨ ì¤€ìˆ˜ ì—¬ë¶€', points: 'ì •í™•í•¨.' },
                       { name: 'ê²½ì²­ íƒœë„', maxScore: 10, score: 10, change: 'up', rule: 'ê³ ê°ì˜ ë§ì„ ì£¼ì˜ ê¹Šê²Œ ë“£ê³  ì´í•´í•˜ë ¤ëŠ” íƒœë„...', points: 'ì ì ˆí•œ ë§ì¥êµ¬...', comment: 'ì´ì „ í”¼ë“œë°± ë°˜ì˜í•˜ì—¬ ê³ ê° ë§ ëŠì§€ ì•Šê³  ì˜ ê²½ì²­í•¨. í›Œë¥­í•¨!' },
                       { name: 'ë¬¸ì˜ ë‚´ìš© íŒŒì•…', maxScore: 15, score: 15, change: 'up', rule: 'ê³ ê° ë¬¸ì˜ì˜ í•µì‹¬ì„ ì •í™•íˆ íŒŒì•…í•˜ëŠ” ëŠ¥ë ¥', points: 'í•µì‹¬ ì§ˆë¬¸ í†µí•´ ëª…í™•í™”...', comment: 'í•µì‹¬ ì§ˆë¬¸ í†µí•´ ì •í™•íˆ íŒŒì•…í•¨.' },
                       { name: 'í•´ê²° ë°©ì•ˆ ì œì‹œ', maxScore: 15, score: 15, change: 'same', rule: 'ê³ ê° ë¬¸ì œ í•´ê²°ì„ ìœ„í•œ ì ì ˆí•˜ê³  ëª…í™•í•œ ë°©ì•ˆ ì œì‹œ', points: 'ì •í™•í•œ ì •ë³´ ê¸°ë°˜...', comment: 'ê³ ê° ë§ì¶¤ í•´ê²°ì±… ì œì‹œ ìš°ìˆ˜.' }
                  ] },
                { id: 'eval-004', date: '2025-04-12', recordingId: 'REC00901', round: '1íšŒì°¨', callType: 'ì¬ì§„', totalScore: 90, evaluator: 'ê¶Œë¯¸', feedbackSummary: 'ì¬ì§„ ì‘ëŒ€ ì–‘í˜¸í•˜ë‚˜ ëª©í‘œ ì ìˆ˜ ë¯¸ë‹¬.', hasObjection: false, objectionText: '', evaluatorResponse: '',
                  details: [
                      { name: 'ì´ì „ ìƒë‹´ ì´ë ¥ í™•ì¸', maxScore: 10, score: 10, change: 'same', rule: 'ì¬ì§„ ê³ ê°ì˜ ì´ì „ ìƒë‹´ ë‚´ìš© í™•ì¸ ë° í™œìš© ì—¬ë¶€', points: 'ì´ì „ ìƒë‹´ ë‚´ìš© ìš”ì•½ ì–¸ê¸‰...', comment: 'ì´ì „ ì´ë ¥ í™•ì¸ ë° í™œìš© ì¢‹ìŒ.' },
                      { name: 'ë¬¸ì˜ ë‚´ìš© ë³€í™” í™•ì¸', maxScore: 10, score: 9, change: 'down', rule: 'ì´ì „ ë¬¸ì˜ ëŒ€ë¹„ í˜„ì¬ ê³ ê° ìƒí™© ë³€í™” í™•ì¸', points: 'í˜¸ì „/ì•…í™” ì—¬ë¶€ ì§ˆë¬¸...', comment: 'ì¶”ê°€ ë¶ˆí¸ì‚¬í•­ í™•ì¸ ì§ˆë¬¸ ëˆ„ë½.' },
                      { name: 'ê³µê° í‘œí˜„', maxScore: 10, score: 9, change: 'down', rule: 'ê³ ê°ì˜ ìƒí™©ê³¼ ê°ì •ì— ëŒ€í•œ ì ì ˆí•œ ê³µê° í‘œí˜„', points: 'ì ì ˆí•œ ê³µê° ì–´íœ˜ ì‚¬ìš©...', comment: 'ë‹¤ì†Œ í˜•ì‹ì ì¸ ê³µê° í‘œí˜„. ê°œì„  í•„ìš”.' }
                  ] },
            ],
            'ê¹€ì² ìˆ˜': [
                { id: 'eval-002', date: '2025-02-28', recordingId: 'REC00456', round: '2íšŒì°¨', callType: 'ì¬ì§„', totalScore: 91, evaluator: 'ê¶Œë¯¸', feedbackSummary: 'ê³µê° í‘œí˜„ ìì—°ìŠ¤ëŸ¬ì›€...', hasObjection: false, objectionText: '', evaluatorResponse: '',
                  details: [
                      { name: 'ì´ì „ ìƒë‹´ ì´ë ¥ í™•ì¸', maxScore: 10, score: 10, change: 'same', rule: 'ì¬ì§„ ê³ ê°ì˜ ì´ì „ ìƒë‹´ ë‚´ìš© í™•ì¸ ë° í™œìš© ì—¬ë¶€', points: 'ì´ì „ ìƒë‹´ ë‚´ìš© ìš”ì•½ ì–¸ê¸‰...', comment: 'ì–‘í˜¸.' },
                      { name: 'ë¬¸ì˜ ë‚´ìš© ë³€í™” í™•ì¸', maxScore: 10, score: 10, change: 'same', rule: 'ì´ì „ ë¬¸ì˜ ëŒ€ë¹„ í˜„ì¬ ê³ ê° ìƒí™© ë³€í™” í™•ì¸', points: 'í˜¸ì „/ì•…í™” ì—¬ë¶€ ì§ˆë¬¸...', comment: 'ë³€í™” ë‚´ìš© ì˜ í™•ì¸ í•¨.' },
                      { name: 'ê³µê° í‘œí˜„', maxScore: 10, score: 10, change: 'up', rule: 'ê³ ê°ì˜ ìƒí™©ê³¼ ê°ì •ì— ëŒ€í•œ ì ì ˆí•œ ê³µê° í‘œí˜„', points: 'ì ì ˆí•œ ê³µê° ì–´íœ˜ ì‚¬ìš©...', comment: 'ë§¤ìš° ìì—°ìŠ¤ëŸ¬ì›€.' }
                  ] },
            ]
        };


        // --- íƒ­ ê¸°ëŠ¥ ---
        function switchTab(event, tabId) {
            console.log(`íƒ­ ì „í™˜: ${tabId}`);
            $$('.tab-content').forEach(content => content.classList.remove('active'));
            $$('.tab-button').forEach(button => button.classList.remove('active'));
            const targetContent = $(`#${tabId}`);
            if (targetContent) {
                targetContent.classList.add('active');
                if (tabId === 'tab-my-results') {
                    // ë‚´ í‰ê°€ ê²°ê³¼ íƒ­ í™œì„±í™” ì‹œ í•„ìš”í•œ ë°ì´í„° ë¡œë“œ ë° ë Œë”ë§
                    const counselorNameEl = $('#my-results-counselor-name');
                    if (counselorNameEl) counselorNameEl.textContent = currentCounselor;
                    displayCurrentGoals(); // í˜„ì¬ ì„¤ì •ëœ ëª©í‘œ í‘œì‹œ
                    renderMyResults(); // í‰ê°€ ê²°ê³¼ ëª©ë¡ ë Œë”ë§
                }
            } else {
                console.error(`IDê°€ ${tabId}ì¸ ì½˜í…ì¸ ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`);
            }
            event.currentTarget.classList.add('active');
        }

        // --- QA í‰ê°€ ì…ë ¥ ê´€ë ¨ ---
        const evaluationTableBody = $('#evaluation-table-body');
        const evaluationTableTitle = $('#evaluation-table-title');
        const totalMaxScoreEl = $('#total-max-score');
        const totalActualScoreEl = $('#total-actual-score');

        // í‰ê°€ ê¸°ì¤€ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í‰ê°€ í•­ëª© í…Œì´ë¸” ë Œë”ë§
        function renderEvaluationItemsFromCriteria(items) {
            if (!evaluationTableBody) return;
            evaluationTableBody.innerHTML = '';
            let totalMaxScore = 0;
            items.forEach(item => {
                const maxScoreValue = parseInt(item.maxScore) || 0;
                totalMaxScore += maxScoreValue;
                const row = document.createElement('tr');
                row.setAttribute('data-item-name', item.name);
                row.classList.add('eval-item-row');
                row.innerHTML = `
                    <td class="font-medium text-aio-dark">${item.name}</td>
                    <td class="text-center">${maxScoreValue}</td>
                    <td><input type="number" class="actual-score-input text-center" min="0" max="${maxScoreValue}" value="${item.score !== undefined ? item.score : 0}" oninput="updateTotalScore()"></td>
                    <td><textarea rows="1" placeholder="ì½”ë©˜íŠ¸ ì…ë ¥...">${item.comment || ''}</textarea></td>
                `;
                evaluationTableBody.appendChild(row);
            });
            if (totalMaxScoreEl) totalMaxScoreEl.textContent = totalMaxScore;
            updateTotalScore(); // ì´ˆê¸° ì´ì  ê³„ì‚°
        }

        // ì‹¤ì œ ì…ë ¥ ì ìˆ˜ í•©ê³„ ì—…ë°ì´íŠ¸
        function updateTotalScore() {
            if (!totalActualScoreEl) return;
            let totalActualScore = 0;
            $$('#evaluation-table-body .actual-score-input').forEach(input => {
                const maxScore = parseInt(input.max) || 0;
                let currentValue = parseInt(input.value) || 0;
                // ì…ë ¥ê°’ì´ ë°°ì ì„ ì´ˆê³¼í•˜ê±°ë‚˜ ìŒìˆ˜ì¼ ê²½ìš° ì¡°ì •
                if (currentValue > maxScore) { currentValue = maxScore; input.value = maxScore; }
                if (currentValue < 0) { currentValue = 0; input.value = 0; }
                totalActualScore += currentValue;
            });
            totalActualScoreEl.textContent = totalActualScore;
        }

        // ì½œ ìœ í˜• ë³€ê²½ ì‹œ í‰ê°€ í•­ëª© ì—…ë°ì´íŠ¸
        function updateEvaluationItems() {
            const callTypeSelect = $('#call_type');
            const selectedCallType = callTypeSelect?.value;
            const criteriaTableBody = $('#criteria-table-body');
            if (!selectedCallType || !evaluationTableTitle || !criteriaTableBody || !evaluationTableBody) {
                console.error("í‰ê°€ í•­ëª© ì—…ë°ì´íŠ¸ì— í•„ìš”í•œ ìš”ì†Œê°€ ì—†ìŠµë‹ˆë‹¤."); return;
            }
            evaluationTableTitle.textContent = `í‰ê°€ í•­ëª© (${selectedCallType})`;
            const criteriaRows = $$('#criteria-table-body tr');
            const extractedItems = [];
            // í‰ê°€ ê¸°ì¤€ ê´€ë¦¬ í…Œì´ë¸”ì—ì„œ í˜„ì¬ ì„ íƒëœ ì½œ ìœ í˜•ì— ë§ëŠ” í•­ëª©ë§Œ ì¶”ì¶œ
            criteriaRows.forEach(row => {
                const rowCallType = row.getAttribute('data-call-type') || row.querySelector('td:first-child select')?.value;
                if (rowCallType === selectedCallType) {
                    const nameInput = row.querySelector('td:nth-child(2) input[type="text"]');
                    const scoreInput = row.querySelector('td:nth-child(3) input[type="number"].criteria-score');
                    if (nameInput && scoreInput) {
                        extractedItems.push({ name: nameInput.value, maxScore: parseInt(scoreInput.value) || 0 });
                    }
                }
            });
            renderEvaluationItemsFromCriteria(extractedItems); // ì¶”ì¶œëœ í•­ëª©ìœ¼ë¡œ í‰ê°€ í…Œì´ë¸” ë‹¤ì‹œ ë Œë”ë§
        }

        // --- í‰ê°€ ê¸°ì¤€ ê´€ë¦¬ ê´€ë ¨ ---
        const criteriaTableBodyManage = $('#criteria-table-body');
        const criteriaFilterSelect = $('#manage_call_type_filter');
        const criteriaMaxScoreSumDisplay = $('#criteria-max-score-sum-display');

        // ì½œ ìœ í˜• í•„í„°ì— ë”°ë¼ í‰ê°€ ê¸°ì¤€ í…Œì´ë¸” í•„í„°ë§ ë° ë°°ì  í•©ê³„ ê³„ì‚°
        function filterCriteriaTable() {
             if (!criteriaFilterSelect || !criteriaTableBodyManage || !criteriaMaxScoreSumDisplay) {
                 console.error("í‰ê°€ ê¸°ì¤€ í•„í„°ë§ì— í•„ìš”í•œ ìš”ì†Œê°€ ì—†ìŠµë‹ˆë‹¤."); return;
             }
            const selectedType = criteriaFilterSelect.value;
            let currentTypeTotalScore = 0;
            const rows = $$('#criteria-table-body tr');
            rows.forEach(row => {
                const rowCallType = row.getAttribute('data-call-type') || row.querySelector('td:first-child select')?.value;
                const scoreInput = row.querySelector('.criteria-score');
                const score = parseInt(scoreInput?.value) || 0;
                if (selectedType === 'ì „ì²´' || rowCallType === selectedType) {
                    row.style.display = ''; // í•„í„° ì¡°ê±´ì— ë§ìœ¼ë©´ í–‰ ë³´ì´ê¸°
                    if (rowCallType === selectedType) currentTypeTotalScore += score; // ì„ íƒëœ ìœ í˜•ì˜ ë°°ì  í•©ì‚°
                } else {
                    row.style.display = 'none'; // í•„í„° ì¡°ê±´ì— ì•ˆ ë§ìœ¼ë©´ í–‰ ìˆ¨ê¸°ê¸°
                }
            });
            // ì„ íƒëœ ìœ í˜•ì˜ ë°°ì  í•©ê³„ í‘œì‹œ ì—…ë°ì´íŠ¸
            if (selectedType !== 'ì „ì²´') {
                criteriaMaxScoreSumDisplay.textContent = `${selectedType} ë°°ì  í•©ê³„: ${currentTypeTotalScore}`;
            } else {
                criteriaMaxScoreSumDisplay.textContent = 'ìœ í˜•ë³„ í•©ê³„: (íŠ¹ì • ìœ í˜• ì„ íƒ ì‹œ í‘œì‹œ)';
            }
        }
        // í‰ê°€ ê¸°ì¤€ í•­ëª© ì‚­ì œ
        function removeCriteriaItem(button) {
            const row = button.closest('tr');
            if (row && confirm('ì´ í‰ê°€ ê¸°ì¤€ í•­ëª©ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                 row.remove();
                 updateCriteriaTotalScore(); // ì‚­ì œ í›„ ë°°ì  í•©ê³„ ì—…ë°ì´íŠ¸
                 updateEvaluationItems(); // QA í‰ê°€ ì…ë ¥ íƒ­ì—ë„ ë°˜ì˜
            }
        }
        // í‰ê°€ ê¸°ì¤€ í•­ëª© ì¶”ê°€
        function addCriteriaItem() {
             if (!criteriaTableBodyManage || !criteriaFilterSelect) return;
            const newRow = document.createElement('tr');
            const selectedFilterType = criteriaFilterSelect.value !== 'ì „ì²´' ? criteriaFilterSelect.value : 'ì´ˆì§„/ì¬ì´ˆì§„'; // ê¸°ë³¸ê°’ ì„¤ì •
            newRow.setAttribute('data-call-type', selectedFilterType);
            newRow.innerHTML = `<td> <select onchange="this.closest('tr').setAttribute('data-call-type', this.value); filterCriteriaTable();"> <option ${selectedFilterType === 'ì´ˆì§„/ì¬ì´ˆì§„' ? 'selected' : ''}>ì´ˆì§„/ì¬ì´ˆì§„</option> <option ${selectedFilterType === 'ì¬ì§„' ? 'selected' : ''}>ì¬ì§„</option> <option ${selectedFilterType === 'ì¼ë°˜' ? 'selected' : ''}>ì¼ë°˜</option> <option ${selectedFilterType === 'ì‹œì²­ì' ? 'selected' : ''}>ì‹œì²­ì</option> </select> </td> <td><input type="text" placeholder="ìƒˆ í‰ê°€ í•­ëª©"></td> <td><input type="number" value="0" class="text-center criteria-score" oninput="updateCriteriaTotalScore()"></td> <td><textarea rows="2" placeholder="í•­ëª© ê·œì •"></textarea></td> <td><textarea rows="2" placeholder="ë§Œì  í¬ì¸íŠ¸"></textarea></td> <td class="text-center"> <button type="button" class="aio-button aio-button-danger text-xs p-1" onclick="removeCriteriaItem(this)"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="m-0 w-4 h-4"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></svg></button> </td>`;
            criteriaTableBodyManage.appendChild(newRow);
            filterCriteriaTable(); // ì¶”ê°€ í›„ í•„í„°ë§ ë° ë°°ì  í•©ê³„ ì—…ë°ì´íŠ¸
        }
        // í‰ê°€ ê¸°ì¤€ ë°°ì  ë³€ê²½ ì‹œ í•©ê³„ ì—…ë°ì´íŠ¸
        function updateCriteriaTotalScore() { filterCriteriaTable(); }

        // --- ëª©í‘œ ì„¤ì • ê¸°ëŠ¥ ---
        function setEvaluationGoal() {
            const year = $('#goal_year').value;
            const round = $('#goal_round').value;
            const goalCallTypeEl = $('#goal_call_type');
            const goalScoreEl = $('#goal_target_score');
            const feedbackEl = $('#goal-set-feedback');

            if (!goalCallTypeEl || !goalScoreEl || !feedbackEl) {
                console.error("ëª©í‘œ ì„¤ì • ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
                return;
            }

            const callType = goalCallTypeEl.value;
            const targetScore = parseInt(goalScoreEl.value);

            // ìœ íš¨ì„± ê²€ì‚¬
            if (isNaN(targetScore) || targetScore < 0 || targetScore > 100) {
                feedbackEl.textContent = 'âš ï¸ ëª©í‘œ ì ìˆ˜ëŠ” 0ì ì—ì„œ 100ì  ì‚¬ì´ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.';
                feedbackEl.className = 'text-sm text-red-600 ml-2';
                setTimeout(() => { feedbackEl.textContent = ''; }, 3000);
                return;
            }

            // ëª©í‘œ ë°ì´í„° ì—…ë°ì´íŠ¸
            if (!userGoals[currentCounselor]) {
                userGoals[currentCounselor] = {};
            }
            if (!userGoals[currentCounselor][year]) {
                userGoals[currentCounselor][year] = {};
            }
            if (!userGoals[currentCounselor][year][round]) {
                userGoals[currentCounselor][year][round] = {};
            }
            userGoals[currentCounselor][year][round][callType] = targetScore;

            console.log(`ëª©í‘œ ì„¤ì •: ${currentCounselor} - ${year}ë…„ ${round}íšŒì°¨ - ${callType} - ${targetScore}ì `);
            feedbackEl.textContent = `âœ… ${year}ë…„ ${round}íšŒì°¨ '${callType}' ìœ í˜• ëª©í‘œ ì ìˆ˜ (${targetScore}ì )ê°€ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤.`;
            feedbackEl.className = 'text-sm text-green-600 ml-2';
            setTimeout(() => { feedbackEl.textContent = ''; }, 3000);

            displayCurrentGoals();
            renderMyResults();
        }

        // í˜„ì¬ ì„¤ì •ëœ ëª©í‘œ ì ìˆ˜ í‘œì‹œ í•¨ìˆ˜
        function displayCurrentGoals() {
            const displayArea = $('#current-goals-display');
            if (!displayArea) return;

            const year = $('#goal_year').value;
            const round = $('#goal_round').value;
            const goals = userGoals[currentCounselor]?.[year]?.[round] || {};

            if (Object.keys(goals).length === 0) {
                displayArea.innerHTML = `<p class="text-sm text-gray-500">${year}ë…„ ${round}íšŒì°¨ì— ì„¤ì •ëœ ëª©í‘œê°€ ì—†ìŠµë‹ˆë‹¤.</p>`;
                return;
            }

            let goalsHtml = `<h3 class="text-sm font-semibold text-gray-600 mb-2">${year}ë…„ ${round}íšŒì°¨ ëª©í‘œ ì ìˆ˜</h3><ul>`;
            for (const callType in goals) {
                goalsHtml += `
                    <li>
                        <div class="goal-info">
                            <span>${callType}</span>
                            <span>${goals[callType]}ì </span>
                        </div>
                    </li>`;
            }
            goalsHtml += '</ul>';
            displayArea.innerHTML = goalsHtml;
        }

        // ë…„ë„ ë³€ê²½ ì‹œ ëª©í‘œ ë¡œë“œ í•¨ìˆ˜
        function loadYearGoals() {
            displayCurrentGoals();
        }

        // íšŒì°¨ ë³€ê²½ ì‹œ ëª©í‘œ ë¡œë“œ í•¨ìˆ˜
        function loadRoundGoals() {
            displayCurrentGoals();
        }

        // --- ë‚´ í‰ê°€ ê²°ê³¼ ê´€ë ¨ ---
        const myResultsBody = $('#my-results-summary-body');

        // ë‚´ í‰ê°€ ê²°ê³¼ ëª©ë¡ ë Œë”ë§
        function renderMyResults() {
            if (!myResultsBody) return;

            const results = evaluationResults[currentCounselor] || [];
            const yearFilter = $('#my_results_year').value;
            const monthFilter = $('#my_results_month').value;
            const callTypeFilter = $('#my_results_call_type').value;

            myResultsBody.innerHTML = ''; // ê¸°ì¡´ ë‚´ìš© ì´ˆê¸°í™”

            // í•„í„°ë§ëœ ê²°ê³¼ë§Œ ë Œë”ë§
            results.filter(result => {
                let show = true;
                if (yearFilter && !result.date.startsWith(yearFilter)) show = false;
                if (monthFilter) {
                    const resultMonth = new Date(result.date).getMonth() + 1;
                    const filterMonth = parseInt(monthFilter.replace('ì›”',''));
                    if (resultMonth !== filterMonth) show = false;
                }
                if (callTypeFilter && result.callType !== callTypeFilter) show = false;
                return show;
            }).forEach(result => {
                // ëª©í‘œ ë‹¬ì„± ì—¬ë¶€ í™•ì¸ ë° ì•„ì´ì½˜ ì„¤ì •
                const targetScore = userGoals[currentCounselor]?.[result.round]?.[result.callType];
                let goalStatusHtml = '-';
                let goalAchievedClass = '';
                if (targetScore !== undefined) {
                    if (result.totalScore >= targetScore) {
                        goalStatusHtml = `<span class="goal-status-icon goal-achieved" title="ëª©í‘œ ë‹¬ì„±! (ëª©í‘œ: ${targetScore}ì )">âœ…</span>`;
                        goalAchievedClass = 'goal-achieved';
                    } else {
                        goalStatusHtml = `<span class="goal-status-icon goal-not-achieved" title="ëª©í‘œ ë¯¸ë‹¬ì„± (ëª©í‘œ: ${targetScore}ì )">âŒ</span>`;
                        goalAchievedClass = 'goal-not-achieved';
                    }
                } else {
                     goalStatusHtml = '<span class="goal-status-icon goal-set" title="í•´ë‹¹ ìœ í˜• ëª©í‘œ ë¯¸ì„¤ì •">â–</span>';
                }

                // ìš”ì•½ í–‰ ìƒì„±
                const summaryRow = document.createElement('tr');
                summaryRow.classList.add('summary-row');
                summaryRow.setAttribute('data-evaluation-id', result.id);
                summaryRow.innerHTML = `
                    <td class="text-center">
                        <button class="toggle-detail-button" onclick="toggleDetail(this)">â–¶</button>
                    </td>
                    <td>${result.date}</td>
                    <td>${result.recordingId}</td>
                    <td class="text-center">${result.round}</td>
                    <td>${result.callType}</td>
                    <td class="text-center">${result.totalScore}</td>
                    <td class="text-center">${goalStatusHtml}</td>
                    <td>${result.evaluator}</td>
                    <td class="truncate">${result.feedbackSummary}</td>
                    <td class="text-center"> <input type="checkbox" class="objection-checkbox" disabled ${result.hasObjection ? 'checked' : ''} title="ì´ì˜ ì œê¸° ${result.hasObjection ? 'ìˆìŒ' : 'ì—†ìŒ'}">
                    </td>
                `;
                myResultsBody.appendChild(summaryRow);

                // ìƒì„¸ ì •ë³´ í–‰ ìƒì„± (ì´ˆê¸° ìˆ¨ê¹€)
                const detailRow = document.createElement('tr');
                detailRow.classList.add('detail-row');
                let detailTableHtml = `
                    <h3 class="text-md font-semibold text-aio-dark mb-3">ìƒì„¸ í‰ê°€ ë‚´ìš© (${result.recordingId}, ${result.date}, ${result.round})</h3>
                    <div class="detail-table-container overflow-x-auto">
                        <table class="detail-table">
                            <colgroup> <col style="width: 16%;"> <col style="width: 7%;"> <col style="width: 8%;"> <col style="width: 8%;"> <col style="width: 20%;"> <col style="width: 20%;"><col style="width: 21%;"> </colgroup>
                            <thead> <tr> <th>í‰ê°€ í•­ëª©</th> <th>ë°°ì </th> <th class="text-center">ëª©í‘œ ì ìˆ˜</th> <th class="text-center">ë‚´ ì ìˆ˜</th> <th>í•­ëª© ê·œì •</th> <th>ë§Œì  í¬ì¸íŠ¸</th> <th>í‰ê°€ì ì½”ë©˜íŠ¸</th> </tr> </thead>
                            <tbody>`;

                // ìƒì„¸ í‰ê°€ í•­ëª© ë Œë”ë§
                if (result.details && Array.isArray(result.details)) {
                    result.details.forEach(detail => {
                        const detailTargetScore = '-'; // í•­ëª©ë³„ ëª©í‘œëŠ” ë¯¸êµ¬í˜„
                        let scoreChangeHtml = ''; // ì ìˆ˜ ë³€í™” ì•„ì´ì½˜
                        if(detail.change === 'up') scoreChangeHtml = '<span class="score-change score-up">â–²</span>';
                        else if(detail.change === 'down') scoreChangeHtml = '<span class="score-change score-down">â–¼</span>';
                        else if(detail.change === 'same') scoreChangeHtml = '<span class="score-change score-same">-</span>';

                        // ì½”ë©˜íŠ¸ê°€ ì—†ê±°ë‚˜ ë¹„ì–´ìˆìœ¼ë©´ '-' í‘œì‹œ
                        const displayComment = detail.comment && detail.comment.trim() !== '' ? detail.comment : '-';

                        detailTableHtml += `
                            <tr>
                                <td>${detail.name || '-'}</td>
                                <td class="text-center">${detail.maxScore || '-'}</td>
                                <td class="text-center">${detailTargetScore}</td>
                                <td class="text-center">${detail.score !== undefined ? detail.score : '-'} ${scoreChangeHtml}</td>
                                <td>${detail.rule || '-'}</td>
                                <td>${detail.points || '-'}</td>
                                <td class="${detail.change === 'down' ? 'text-red-600' : ''}">${displayComment}</td>
                            </tr>`;
                    });
                } else {
                    detailTableHtml += '<tr><td colspan="7" class="text-center text-gray-500">ìƒì„¸ í‰ê°€ í•­ëª© ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
                }


                detailTableHtml += `</tbody></table></div>`;

                // ì „ì²´ í”¼ë“œë°± ë° ì´ì˜ ì œê¸° ì„¹ì…˜ ì¶”ê°€
                detailTableHtml += `
                    <h4 class="text-sm font-semibold text-aio-dark mt-4 mb-1">ì „ì²´ í”¼ë“œë°± :</h4>
                    <p class="text-sm text-gray-700 mb-4">${result.feedbackSummary}</p>
                    
                    <!-- ìƒë‹´ì‚¬ ì˜ê²¬ ì„¹ì…˜ ì¶”ê°€ -->
                    <div class="counselor-feedback-section mt-4">
                        <h4 class="text-sm font-semibold text-aio-dark mb-1">ìƒë‹´ì‚¬ ì˜ê²¬</h4>
                        <textarea class="counselor-feedback-textarea w-full text-sm" rows="3" placeholder="í‰ê°€ ê²°ê³¼ì— ëŒ€í•œ ìƒë‹´ì‚¬ ì˜ê²¬ì„ ì…ë ¥í•˜ì„¸ìš”..." ${result.counselorFeedback ? 'disabled' : ''}>${result.counselorFeedback || ''}</textarea>
                        <div class="counselor-feedback-status text-xs text-green-600 mt-1 mb-2 h-4">${result.counselorFeedback ? 'âœ… ìƒë‹´ì‚¬ ì˜ê²¬ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.' : ''}</div>
                        <div class="flex justify-end space-x-2 mt-2">
                            <button type="button" class="save-feedback-btn aio-button aio-button-primary text-xs py-1 px-2" ${result.counselorFeedback ? 'disabled' : ''}>
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></svg>
                                ì €ì¥
                            </button>
                            <button type="button" class="edit-feedback-btn aio-button aio-button-secondary text-xs py-1 px-2" ${!result.counselorFeedback ? 'disabled' : ''}>
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4"><path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"/><path d="m15 5 4 4"/></svg>
                                ìˆ˜ì •
                            </button>
                            <button type="button" class="delete-feedback-btn aio-button aio-button-danger text-xs py-1 px-2" ${!result.counselorFeedback ? 'disabled' : ''}>
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></svg>
                                ì‚­ì œ
                            </button>
                        </div>
                    </div>

                    <div class="objection-section-container">
                        <div class="objection-section counselor-objection-section">
                            <h4 class="text-sm font-semibold text-aio-dark mb-1">ì´ì˜ ì œê¸°(ìƒë‹´ì‚¬)</h4>
                            <textarea class="objection-textarea counselor-objection-textarea w-full text-sm" rows="3" placeholder="í‰ê°€ ê²°ê³¼ì— ëŒ€í•œ ì´ì˜ ì œê¸° ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”..." ${result.objectionText ? 'disabled' : ''}>${result.objectionText || ''}</textarea>
                            <div class="objection-status counselor-objection-status text-xs text-green-600 mt-1 mb-2 h-4">${result.objectionText ? 'âœ… ì´ì˜ ì œê¸°ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.' : ''}</div>
                            <div class="flex justify-end space-x-2 mt-2">
                                <button type="button" class="save-objection-btn counselor-save-objection-btn aio-button aio-button-primary text-xs py-1 px-2" ${result.objectionText ? 'disabled' : ''}> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></svg> ì €ì¥ </button>
                                <button type="button" class="edit-objection-btn counselor-edit-objection-btn aio-button aio-button-secondary text-xs py-1 px-2" ${!result.objectionText ? 'disabled' : ''}> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4"><path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"/><path d="m15 5 4 4"/></svg> ìˆ˜ì • </button>
                                <button type="button" class="delete-objection-btn counselor-delete-objection-btn aio-button aio-button-danger text-xs py-1 px-2" ${!result.objectionText ? 'disabled' : ''}> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></svg> ì‚­ì œ </button>
                            </div>
                        </div>
                        <div class="objection-section evaluator-objection-section">
                             <h4 class="text-sm font-semibold text-aio-dark mb-1">í‰ê°€ì ë‹µë³€</h4>
                             <textarea class="objection-textarea evaluator-objection-textarea w-full text-sm" rows="3" placeholder="ì´ì˜ ì œê¸°ì— ëŒ€í•œ í‰ê°€ì ë‹µë³€ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”..." ${result.evaluatorResponse ? 'disabled' : ''}>${result.evaluatorResponse || ''}</textarea>
                             <div class="objection-status evaluator-objection-status text-xs text-green-600 mt-1 mb-2 h-4">${result.evaluatorResponse ? 'âœ… ë‹µë³€ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.' : ''}</div>
                             <div class="flex justify-end space-x-2 mt-2">
                                 <button type="button" class="save-objection-btn evaluator-save-objection-btn aio-button aio-button-primary text-xs py-1 px-2" ${result.evaluatorResponse ? 'disabled' : ''}> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></svg> ë‹µë³€ ì €ì¥ </button>
                                 <button type="button" class="edit-objection-btn evaluator-edit-objection-btn aio-button aio-button-secondary text-xs py-1 px-2" ${!result.evaluatorResponse ? 'disabled' : ''}> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4"><path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"/><path d="m15 5 4 4"/></svg> ìˆ˜ì • </button>
                                 <button type="button" class="delete-objection-btn evaluator-delete-objection-btn aio-button aio-button-danger text-xs py-1 px-2" ${!result.evaluatorResponse ? 'disabled' : ''}> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></svg> ì‚­ì œ </button>
                             </div>
                        </div>
                    </div>`;

                detailRow.innerHTML = `<td colspan="10" class="detail-cell">${detailTableHtml}</td>`;
                myResultsBody.appendChild(detailRow);
            });
        }


        // ìƒì„¸ ì •ë³´ í† ê¸€ í•¨ìˆ˜
        function toggleDetail(button) {
            const summaryRow = button.closest('.summary-row');
            const detailRow = summaryRow?.nextElementSibling;
            if (detailRow && detailRow.classList.contains('detail-row')) {
                const isActive = detailRow.classList.toggle('active'); // active í´ë˜ìŠ¤ í† ê¸€
                button.textContent = isActive ? 'â–¼' : 'â–¶'; // ë²„íŠ¼ í…ìŠ¤íŠ¸ ë³€ê²½

                // í•˜ë‚˜ë§Œ ì—´ë¦¬ë„ë¡ ë‹¤ë¥¸ ì—´ë¦° ìƒì„¸ ì •ë³´ ë‹«ê¸°
                if (isActive) {
                    $$('#my-results-summary-body .detail-row.active').forEach(openDetailRow => {
                        if (openDetailRow !== detailRow) {
                            openDetailRow.classList.remove('active');
                            const correspondingButton = openDetailRow.previousElementSibling?.querySelector('.toggle-detail-button');
                            if(correspondingButton) correspondingButton.textContent = 'â–¶';
                        }
                    });
                }
            }
        }

        // --- ì‚¬ì´ë“œ íŒ¨ë„ ê´€ë ¨ ---
        const sidePanelOverlay = $('#criteria-side-panel-overlay');
        const sidePanel = $('#criteria-side-panel');
        const panelItemName = $('#panel-item-name');
        const panelItemRule = $('#panel-item-rule');
        const panelItemPoints = $('#panel-item-points');

        // í‰ê°€ ê¸°ì¤€ ìƒì„¸ ì •ë³´ ì‚¬ì´ë“œ íŒ¨ë„ í‘œì‹œ
        function showSidePanel(itemName, callType) {
             if (!criteriaTableBodyManage || !panelItemName || !panelItemRule || !panelItemPoints || !sidePanelOverlay || !sidePanel) {
                 console.error("ì‚¬ì´ë“œ íŒ¨ë„ í‘œì‹œì— í•„ìš”í•œ ìš”ì†Œê°€ ì—†ìŠµë‹ˆë‹¤."); return;
             }
            const criteriaRows = $$('#criteria-table-body tr');
            let foundRule = 'í•´ë‹¹ ê¸°ì¤€ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
            let foundPoints = '-';
            // í‰ê°€ ê¸°ì¤€ ê´€ë¦¬ í…Œì´ë¸”ì—ì„œ í•´ë‹¹ í•­ëª© ì •ë³´ ì°¾ê¸°
            for (const row of criteriaRows) {
                const rowCallType = row.getAttribute('data-call-type') || row.querySelector('td:first-child select')?.value;
                const nameInput = row.querySelector('td:nth-child(2) input[type="text"]');
                if (rowCallType === callType && nameInput && nameInput.value === itemName) {
                    const ruleTextarea = row.querySelector('td:nth-child(4) textarea');
                    const pointsTextarea = row.querySelector('td:nth-child(5) textarea');
                    foundRule = ruleTextarea ? ruleTextarea.value : 'ì •ë³´ ì—†ìŒ';
                    foundPoints = pointsTextarea ? pointsTextarea.value : 'ì •ë³´ ì—†ìŒ';
                    break;
                }
            }
            // íŒ¨ë„ ë‚´ìš© ì—…ë°ì´íŠ¸ ë° í‘œì‹œ
            panelItemName.textContent = itemName;
            panelItemRule.textContent = foundRule;
            panelItemPoints.textContent = foundPoints;
            sidePanelOverlay.classList.add('active');
            sidePanel.classList.add('active');
        }
        // ì‚¬ì´ë“œ íŒ¨ë„ ìˆ¨ê¸°ê¸°
        function hideSidePanel() {
            if (sidePanelOverlay && sidePanel) {
                sidePanelOverlay.classList.remove('active');
                sidePanel.classList.remove('active');
            }
        }
        // QA í‰ê°€ ì…ë ¥ í…Œì´ë¸”ì˜ í•­ëª© ì´ë¦„ í´ë¦­ ì‹œ ì‚¬ì´ë“œ íŒ¨ë„ í‘œì‹œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        if (evaluationTableBody) {
             evaluationTableBody.addEventListener('click', (event) => {
                 const targetCell = event.target.closest('td');
                 const targetRow = event.target.closest('.eval-item-row');
                 // ì²« ë²ˆì§¸ ì…€(í•­ëª© ì´ë¦„) í´ë¦­ ì‹œ
                 if (targetRow && targetCell && targetRow.cells[0] === targetCell) {
                     const itemName = targetRow.getAttribute('data-item-name');
                     const currentCallType = $('#call_type')?.value;
                     if (itemName && currentCallType) {
                         showSidePanel(itemName, currentCallType);
                     }
                 }
             });
        }

        // --- ì´ì˜ ì œê¸° ê¸°ëŠ¥ ê´€ë ¨ ---
        if (myResultsBody) {
            // ì´ì˜ ì œê¸° ì„¹ì…˜ ë‚´ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ (ì´ë²¤íŠ¸ ìœ„ì„ ì‚¬ìš©)
            myResultsBody.addEventListener('click', (event) => {
                const button = event.target.closest('.save-objection-btn, .edit-objection-btn, .delete-objection-btn');
                if (!button) return; // ê´€ë ¨ ë²„íŠ¼ì´ ì•„ë‹ˆë©´ ì¢…ë£Œ

                const objectionSection = button.closest('.objection-section');
                if (!objectionSection) return;

                const isCounselorSection = objectionSection.classList.contains('counselor-objection-section');
                const sectionPrefix = isCounselorSection ? 'counselor' : 'evaluator';
                const textarea = objectionSection.querySelector(`.${sectionPrefix}-objection-textarea`);
                const saveBtn = objectionSection.querySelector(`.${sectionPrefix}-save-objection-btn`);
                const editBtn = objectionSection.querySelector(`.${sectionPrefix}-edit-objection-btn`);
                const deleteBtn = objectionSection.querySelector(`.${sectionPrefix}-delete-objection-btn`);
                const statusDiv = objectionSection.querySelector(`.${sectionPrefix}-objection-status`);
                const summaryRow = objectionSection.closest('.detail-row')?.previousElementSibling;
                const checkbox = summaryRow?.querySelector('td:last-child input[type="checkbox"]'); // ìš”ì•½ í–‰ì˜ ì²´í¬ë°•ìŠ¤

                if (!textarea || !saveBtn || !editBtn || !deleteBtn || !statusDiv) {
                    console.error("ì´ì˜ ì œê¸° ì„¹ì…˜ì˜ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.", sectionPrefix); return;
                }

                statusDiv.textContent = ''; // ìƒíƒœ ë©”ì‹œì§€ ì´ˆê¸°í™”
                const messagePrefix = isCounselorSection ? 'ì´ì˜ ì œê¸°' : 'ë‹µë³€';

                // ì €ì¥ ë²„íŠ¼ í´ë¦­ ì‹œ
                if (button.classList.contains('save-objection-btn')) {
                    textarea.disabled = true; // í…ìŠ¤íŠ¸ ì˜ì—­ ë¹„í™œì„±í™”
                    saveBtn.disabled = true; // ì €ì¥ ë²„íŠ¼ ë¹„í™œì„±í™”
                    editBtn.disabled = false; // ìˆ˜ì • ë²„íŠ¼ í™œì„±í™”
                    deleteBtn.disabled = false; // ì‚­ì œ ë²„íŠ¼ í™œì„±í™”
                    statusDiv.textContent = `âœ… ${messagePrefix}ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.`;
                    if (checkbox) checkbox.checked = true; // ì´ì˜ ì œê¸° ì²´í¬ë°•ìŠ¤ í™œì„±í™”
                    setTimeout(() => { statusDiv.textContent = ''; }, 3000); // 3ì´ˆ í›„ ë©”ì‹œì§€ ìˆ¨ê¹€
                    console.log(`${sectionPrefix} Objection saved:`, textarea.value);
                    // TODO: ì‹¤ì œ ë°ì´í„° ì €ì¥ ë¡œì§ ì¶”ê°€ (evaluationResults ì—…ë°ì´íŠ¸ ë“±)

                // ìˆ˜ì • ë²„íŠ¼ í´ë¦­ ì‹œ
                } else if (button.classList.contains('edit-objection-btn')) {
                    textarea.disabled = false; // í…ìŠ¤íŠ¸ ì˜ì—­ í™œì„±í™”
                    saveBtn.disabled = false; // ì €ì¥ ë²„íŠ¼ í™œì„±í™”
                    editBtn.disabled = true; // ìˆ˜ì • ë²„íŠ¼ ë¹„í™œì„±í™”
                    deleteBtn.disabled = true; // ì‚­ì œ ë²„íŠ¼ ë¹„í™œì„±í™”
                    textarea.focus(); // í…ìŠ¤íŠ¸ ì˜ì—­ì— í¬ì»¤ìŠ¤
                    statusDiv.textContent = 'ğŸ“ ìˆ˜ì • ì¤‘...';
                    console.log(`Editing ${sectionPrefix} objection...`);

                // ì‚­ì œ ë²„íŠ¼ í´ë¦­ ì‹œ
                } else if (button.classList.contains('delete-objection-btn')) {
                    if (confirm(`${messagePrefix} ë‚´ìš©ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                        textarea.value = ''; // í…ìŠ¤íŠ¸ ì˜ì—­ ë‚´ìš© ì‚­ì œ
                        textarea.disabled = false; // í…ìŠ¤íŠ¸ ì˜ì—­ í™œì„±í™” (ìƒˆë¡œ ì…ë ¥ ê°€ëŠ¥í•˜ë„ë¡)
                        saveBtn.disabled = false; // ì €ì¥ ë²„íŠ¼ í™œì„±í™”
                        editBtn.disabled = true; // ìˆ˜ì • ë²„íŠ¼ ë¹„í™œì„±í™”
                        deleteBtn.disabled = true; // ì‚­ì œ ë²„íŠ¼ ë¹„í™œì„±í™”
                        statusDiv.textContent = `ğŸ—‘ï¸ ${messagePrefix}ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.`;
                        setTimeout(() => { statusDiv.textContent = ''; }, 3000);
                        console.log(`${sectionPrefix} Objection deleted.`);
                        // TODO: ì‹¤ì œ ë°ì´í„° ì‚­ì œ ë¡œì§ ì¶”ê°€ (evaluationResults ì—…ë°ì´íŠ¸ ë“±)

                        // ìƒë‹´ì‚¬ ì´ì˜ ì œê¸°ì™€ í‰ê°€ì ë‹µë³€ ëª¨ë‘ ì—†ìœ¼ë©´ ì²´í¬ë°•ìŠ¤ í•´ì œ
                        const detailRow = objectionSection.closest('.detail-row');
                        if (detailRow && checkbox) {
                            const otherPrefix = isCounselorSection ? 'evaluator' : 'counselor';
                            const otherTextarea = detailRow.querySelector(`.${otherPrefix}-objection-textarea`);
                            if ((!otherTextarea || otherTextarea.value.trim() === '') && textarea.value.trim() === '') {
                                checkbox.checked = false;
                            }
                        }
                    }
                }
            });
        }

        // --- ì´ˆê¸°í™” ---
        document.addEventListener('DOMContentLoaded', () => {
            // í‰ê°€ì¼ì, ì ìš©ì¼ì ê¸°ë³¸ê°’ ì˜¤ëŠ˜ ë‚ ì§œë¡œ ì„¤ì •
            const today = new Date().toISOString().split('T')[0];
            const evalDateInput = $('#eval_date');
            if (evalDateInput && !evalDateInput.value) evalDateInput.value = today;
            const otherMetricDateInput = $('#other_metric_date');
            if (otherMetricDateInput && !otherMetricDateInput.value) otherMetricDateInput.value = today;

            // ë¡œê·¸ì¸í•œ ìƒë‹´ì‚¬ ì´ë¦„ í‘œì‹œ
            const counselorNameSpan = $('#current-counselor-name');
            if(counselorNameSpan) counselorNameSpan.textContent = currentCounselor;

            // ì•½ê°„ì˜ ì§€ì—° í›„ ì´ˆê¸° ë°ì´í„° ë¡œë“œ ë° ë Œë”ë§ ì‹¤í–‰ (DOM ìš”ì†Œ ë¡œë“œ ë³´ì¥)
            setTimeout(() => {
                if (typeof updateEvaluationItems === 'function') { updateEvaluationItems(); } // QA í‰ê°€ ì…ë ¥ í•­ëª© ì´ˆê¸° ë¡œë“œ
                if (typeof filterCriteriaTable === 'function') { filterCriteriaTable(); } // í‰ê°€ ê¸°ì¤€ í…Œì´ë¸” ì´ˆê¸° í•„í„°ë§

                // ì²« ë²ˆì§¸ íƒ­ í™œì„±í™” (ë‚´ í‰ê°€ ê²°ê³¼ ë Œë”ë§ í¬í•¨)
                const firstTabButton = $('.tab-button');
                if(firstTabButton) {
                    const onclickAttr = firstTabButton.getAttribute('onclick');
                    const match = onclickAttr ? onclickAttr.match(/'([^']+)'/) : null;
                    if (match && match[1]) {
                        const firstTabId = match[1];
                        switchTab({ currentTarget: firstTabButton }, firstTabId);
                    } else { console.error("ì²« ë²ˆì§¸ íƒ­ì˜ IDë¥¼ ì¶”ì¶œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤."); }
                }
            }, 50); // 50ms ì§€ì—°
        });

        // --- í‰ê°€ ê¸°ì¤€ ê´€ë¦¬ ê¸°ëŠ¥ ---
        function addEvaluationItem() {
            const mallType = $('#mall_type_filter').value;
            const callType = mallType === 'ì „ì²´' ? '' : $('#call_type_filter').value;
            const itemName = $('#item_name').value;
            const itemDescription = $('#item_description').value;
            const itemScore = parseInt($('#item_score').value);
            const itemWeight = parseInt($('#item_weight').value);

            // ìœ íš¨ì„± ê²€ì‚¬
            if (!itemName || !itemDescription || isNaN(itemScore) || isNaN(itemWeight)) {
                alert('ëª¨ë“  í•„ë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            // ìƒˆë¡œìš´ í‰ê°€ í•­ëª© ìƒì„±
            const newItem = {
                id: Date.now(), // ì„ì‹œ ID
                mallType: mallType,
                callType: callType,
                name: itemName,
                description: itemDescription,
                score: itemScore,
                weight: itemWeight,
                status: 'í™œì„±'
            };

            // í‰ê°€ í•­ëª© ëª©ë¡ì— ì¶”ê°€
            evaluationItems.push(newItem);

            // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
            $('#item_name').value = '';
            $('#item_description').value = '';
            $('#item_score').value = '';
            $('#item_weight').value = '';

            // í‰ê°€ í•­ëª© ëª©ë¡ ì—…ë°ì´íŠ¸
            renderEvaluationItems();
        }

        let counselorFeedback = {
            isEditing: false,
            content: ''
        };

        function toggleFeedbackEdit() {
            const textarea = document.getElementById('counselor-feedback');
            const editBtn = document.getElementById('edit-feedback-btn');
            const saveBtn = document.getElementById('save-feedback-btn');
            
            counselorFeedback.isEditing = !counselorFeedback.isEditing;
            
            if (counselorFeedback.isEditing) {
                textarea.readOnly = false;
                textarea.classList.add('border-blue-500');
                editBtn.textContent = 'âœ–ï¸ ì·¨ì†Œ';
                saveBtn.style.display = 'inline-flex';
            } else {
                textarea.readOnly = true;
                textarea.classList.remove('border-blue-500');
                editBtn.textContent = 'âœï¸ ìˆ˜ì •';
                saveBtn.style.display = 'none';
                textarea.value = counselorFeedback.content;
            }
        }

        function saveCounselorFeedback() {
            const textarea = document.getElementById('counselor-feedback');
            counselorFeedback.content = textarea.value;
            
            // ì €ì¥ ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ
            const toast = document.createElement('div');
            toast.className = 'fixed bottom-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg';
            toast.textContent = 'ìƒë‹´ì‚¬ ì˜ê²¬ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.';
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.remove();
            }, 3000);
            
            // ìˆ˜ì • ëª¨ë“œ ì¢…ë£Œ
            toggleFeedbackEdit();
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸° ì„¤ì •
        document.addEventListener('DOMContentLoaded', () => {
            const textarea = document.getElementById('counselor-feedback');
            const saveBtn = document.getElementById('save-feedback-btn');
            
            // ì´ˆê¸° ìƒíƒœ ì„¤ì •
            textarea.readOnly = true;
            saveBtn.style.display = 'none';
            
            // ê¸°ì¡´ ì˜ê²¬ì´ ìˆë‹¤ë©´ ë¶ˆëŸ¬ì˜¤ê¸°
            if (counselorFeedback.content) {
                textarea.value = counselorFeedback.content;
            }
        });

        // ìƒë‹´ì‚¬ ì˜ê²¬ ê¸°ëŠ¥ ê´€ë ¨ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
        if (myResultsBody) {
            // ìƒë‹´ì‚¬ ì˜ê²¬ ì„¹ì…˜ ë‚´ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
            myResultsBody.addEventListener('click', (event) => {
                const button = event.target.closest('.save-feedback-btn, .edit-feedback-btn, .delete-feedback-btn');
                if (!button) return;

                const feedbackSection = button.closest('.counselor-feedback-section');
                if (!feedbackSection) return;

                const textarea = feedbackSection.querySelector('.counselor-feedback-textarea');
                const saveBtn = feedbackSection.querySelector('.save-feedback-btn');
                const editBtn = feedbackSection.querySelector('.edit-feedback-btn');
                const deleteBtn = feedbackSection.querySelector('.delete-feedback-btn');
                const statusDiv = feedbackSection.querySelector('.counselor-feedback-status');

                if (!textarea || !saveBtn || !editBtn || !deleteBtn || !statusDiv) {
                    console.error("ìƒë‹´ì‚¬ ì˜ê²¬ ì„¹ì…˜ì˜ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
                    return;
                }

                statusDiv.textContent = '';

                // ì €ì¥ ë²„íŠ¼ í´ë¦­ ì‹œ
                if (button.classList.contains('save-feedback-btn')) {
                    textarea.disabled = true;
                    saveBtn.disabled = true;
                    editBtn.disabled = false;
                    deleteBtn.disabled = false;
                    statusDiv.textContent = 'âœ… ìƒë‹´ì‚¬ ì˜ê²¬ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.';
                    setTimeout(() => { statusDiv.textContent = ''; }, 3000);
                    console.log("Counselor feedback saved:", textarea.value);
                    // TODO: ì‹¤ì œ ë°ì´í„° ì €ì¥ ë¡œì§ ì¶”ê°€

                // ìˆ˜ì • ë²„íŠ¼ í´ë¦­ ì‹œ
                } else if (button.classList.contains('edit-feedback-btn')) {
                    textarea.disabled = false;
                    saveBtn.disabled = false;
                    editBtn.disabled = true;
                    deleteBtn.disabled = true;
                    textarea.focus();
                    statusDiv.textContent = 'ğŸ“ ìˆ˜ì • ì¤‘...';
                    console.log("Editing counselor feedback...");

                // ì‚­ì œ ë²„íŠ¼ í´ë¦­ ì‹œ
                } else if (button.classList.contains('delete-feedback-btn')) {
                    if (confirm('ìƒë‹´ì‚¬ ì˜ê²¬ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                        textarea.value = '';
                        textarea.disabled = false;
                        saveBtn.disabled = false;
                        editBtn.disabled = true;
                        deleteBtn.disabled = true;
                        statusDiv.textContent = 'ğŸ—‘ï¸ ìƒë‹´ì‚¬ ì˜ê²¬ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.';
                        setTimeout(() => { statusDiv.textContent = ''; }, 3000);
                        console.log("Counselor feedback deleted.");
                        // TODO: ì‹¤ì œ ë°ì´í„° ì‚­ì œ ë¡œì§ ì¶”ê°€
                    }
                }
            });
        }

    </script>

</body>
</html>